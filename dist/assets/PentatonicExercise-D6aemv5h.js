import{u as pe,c as fe,d as ue,r as h,l as F,n as xe,g as L,s as ne,j as e,F as ge,m as je,i as oe,f as ye,p as Ne}from"./index-CwJpEdkT.js";import{a as C}from"./theoryEngine-Kyf7K1I3.js";import{D as be}from"./DisplayModeToggle-BpGImax5.js";import{P as ve}from"./PracticeRating-BzD00yR0.js";import"./tone-BWNjRQgH.js";const se=["C","Db","D","Eb","E","F","F#","G","Ab","A","Bb","B"],ae=["Ionian (Major)","Dorian","Phrygian","Lydian","Mixolydian","Aeolian (Natural Minor)","Locrian"],Se=[5,0,1,2,4],Me=[0,1,2,4,5],Ce=["Root","b3","4","5","b7"],Ee=["Root","2","3","5","6"],J=[{name:"aeolian",displayName:"Aeolian (Natural Minor)"},{name:"dorian",displayName:"Dorian"},{name:"phrygian",displayName:"Phrygian"}],z=[{name:"major",displayName:"Ionian (Major)"},{name:"lydian",displayName:"Lydian"},{name:"mixolydian",displayName:"Mixolydian"}],U=[{name:"blues",displayName:"Blues Scale"},{name:"harmonic minor",displayName:"Harmonic Minor"},{name:"melodic minor",displayName:"Melodic Minor (Jazz Minor)"}];function _(i){return i.map(j=>F(j).chroma).filter(j=>j!==void 0)}function W(i){return je(i)||i}function we(i,j,p){const y=_(C(i,j==="minor"?"minor pentatonic":"major pentatonic")),E=_(C(i,p));return y.filter(S=>!E.includes(S))}function X(i,j,p,u,y){const S=C(i,j==="minor"?"minor pentatonic":"major pentatonic");if(!S||S.length===0)return[];const D=_(S),O=D[0],T=[];for(let m=0;m<=22;m++){const n=L({string:0,fret:m},u),a=F(n).chroma;a!==void 0&&D.includes(a)&&T.push({fret:m,chroma:a})}const b=T.findIndex(m=>m.chroma===O);if(b===-1)return[];const M=b+p;if(M>=T.length)return[];let v=T[M].fret;v>12&&(v-=12);const R=[];for(let m=0;m<y;m++){const n=[];for(let o=0;o<=22;o++){const r=L({string:m,fret:o},u),c=F(r).chroma;c!==void 0&&D.includes(c)&&n.push(o)}let a=[],s=1/0;for(let o=0;o<n.length-1;o++){const r=[n[o],n[o+1]];if(r[0]>=v-1&&r[1]<=v+4){const c=Math.abs(r[0]-v);c<s&&(s=c,a=r)}}if(a.length===0)for(let o=0;o<n.length-1;o++){const r=[n[o],n[o+1]];if(r[1]-r[0]<=5){const c=(r[0]+r[1])/2,I=Math.abs(c-(v+1.5));I<s&&(s=I,a=r)}}a.forEach(o=>R.push({string:m,fret:o}))}return R}function Pe(i,j,p,u,y,E){if(i.length===0)return[];const S=p==="minor"?"minor pentatonic":"major pentatonic",D=E||(p==="minor"?"aeolian":"major"),O=_(C(j,S)),b=_(C(j,D)).filter(n=>!O.includes(n));if(b.length===0)return[];const M=i.map(n=>n.fret),v=Math.min(...M),R=Math.max(...M),m=[];for(let n=0;n<y;n++)for(let a=Math.max(0,v-1);a<=R+1;a++){const s=L({string:n,fret:a},u),o=F(s).chroma;o!==void 0&&b.includes(o)&&m.push({string:n,fret:a})}return m}const _e=({exercise:i})=>{const{instrument:j,stringCount:p,tuning:u,setHighlightedPositions:y,setSecondaryHighlightedPositions:E,setRootNote:S,clearHighlights:D}=pe(),{droneConfig:O,setDroneConfig:T,isDroneActive:b,setDroneActive:M}=fe(),{isActive:v}=ue(),R=p<=4?"4th":p===5?"5th":"6th",m=j==="bass",[n,a]=h.useState("A"),[s,o]=h.useState("minor"),[r,c]=h.useState(0),[I,f]=h.useState(!1),[B,re]=h.useState(!1),[K,Y]=h.useState(!1),[N,q]=h.useState(null);h.useEffect(()=>{const t=i.id;t==="pentatonic-1"?(o("minor"),c(0),f(!1),a("A")):t==="pentatonic-minor-2"?(o("minor"),c(1),f(!1),a("A")):t==="pentatonic-minor-3"?(o("minor"),c(2),f(!1),a("A")):t==="pentatonic-minor-4"?(o("minor"),c(3),f(!1),a("A")):t==="pentatonic-minor-5"?(o("minor"),c(4),f(!1),a("A")):t==="pentatonic-major-1"?(o("major"),c(0),f(!1),a("C")):t==="pentatonic-major-2"?(o("major"),c(1),f(!1),a("C")):t==="pentatonic-major-3"?(o("major"),c(2),f(!1),a("C")):t==="pentatonic-major-4"?(o("major"),c(3),f(!1),a("C")):t==="pentatonic-major-5"?(o("major"),c(4),f(!1),a("C")):t==="pentatonic-4"?(o("minor"),c(0),f(!0),a("A")):t==="pentatonic-5"&&(o("minor"),c(0),f(!0),a("A"),q("aeolian"))},[i.id]),h.useEffect(()=>{i.id!=="pentatonic-5"||!N||(J.some(t=>t.name===N)||U.some(t=>t.name===N)?o("minor"):z.some(t=>t.name===N)&&o("major"))},[N,i.id]);const Q=s==="minor"?Se:Me,V=s==="minor"?Ce:Ee,Z=ae[Q[r]],ie=V[r],le=h.useCallback(t=>{const d=s==="minor"?"minor pentatonic":"major pentatonic",x=t||(s==="minor"?"aeolian":"major"),l=_(C(n,d));return C(n,x).filter($=>{const H=F($).chroma;return H!==void 0&&!l.includes(H)}).map(W)},[n,s]),ce=h.useCallback(()=>{const d=C(n,s==="minor"?"minor pentatonic":"major pentatonic");return r<d.length?W(d[r]):n},[n,s,r]),ee=h.useCallback(()=>{if(!v)return;const t=X(n,s,r,u,p);if(S(xe(n)),B){const d=[],x=[];for(let l=0;l<5;l++){const g=X(n,s,l,u,p);l===r?x.push(...g):d.push(...g)}y(x),E(d)}else if(I){const d=i.id==="pentatonic-5"&&N||void 0;if(d){const l=we(n,s,d);if(l.length>0){const g=t.filter($=>{const H=L($,u),te=F(H).chroma;return te===void 0||!l.includes(te)});y(g)}else y(t)}else y(t);const x=Pe(t,n,s,u,p,d);E(x)}else y(t),E([])},[v,n,s,r,I,B,u,p,N,i.id,y,E,S]);h.useEffect(()=>{ee()},[ee]),h.useEffect(()=>()=>{D(),b&&(ne(),M(!1))},[D,b,M]);const de=async()=>{await oe(),b?(ne(),M(!1)):(T({note:n,octave:2}),ye({note:n,octave:2,volume:O.volume,waveform:O.waveform}),M(!0))},me=async()=>{if(K)return;await oe(),Y(!0);const d=[...X(n,s,r,u,p)].sort((l,g)=>l.string!==g.string?l.string-g.string:l.fret-g.fret),x=.25;for(let l=0;l<d.length;l++){const g=L(d[l],u);Ne(g,{duration:.4,velocity:.7,delay:l*x})}setTimeout(()=>Y(!1),d.length*x*1e3+500)},he=h.useCallback(t=>{if(!t)return[];const x=C(n,s==="minor"?"minor pentatonic":"major pentatonic"),l=_(C(n,t));return x.filter(g=>{const $=F(g).chroma;return $!==void 0&&!l.includes($)}).map(W)},[n,s]),w=le(i.id==="pentatonic-5"&&N||void 0),P=he(i.id==="pentatonic-5"&&N||void 0),G=ce(),A=i.id==="pentatonic-5",k=[...J,...z,...U].find(t=>t.name===N)?.displayName??N??"";return e.jsxs("div",{className:"space-y-6",children:[A&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"var(--text-primary)"},children:"Target Mode"}),e.jsxs("select",{value:N||"",onChange:t=>q(t.target.value),className:"w-full px-3 py-2 rounded-lg",style:{backgroundColor:"var(--bg-primary)",color:"var(--text-primary)",border:"1px solid var(--border-color)"},children:[e.jsx("optgroup",{label:"Minor Modes (from minor pentatonic)",children:J.map(t=>e.jsx("option",{value:t.name,children:t.displayName},t.name))}),e.jsx("optgroup",{label:"Major Modes (from major pentatonic)",children:z.map(t=>e.jsx("option",{value:t.name,children:t.displayName},t.name))}),e.jsx("optgroup",{label:"Other Scales (from minor pentatonic)",children:U.map(t=>e.jsx("option",{value:t.name,children:t.displayName},t.name))})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",style:{color:"var(--text-primary)"},children:["Key (",k,")"]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:se.map(t=>e.jsx("button",{onClick:()=>a(t),className:`px-3 py-2 rounded-lg font-medium transition-all min-w-[44px] ${n===t?"btn-primary":""}`,style:n!==t?{backgroundColor:"var(--bg-tertiary)",color:"var(--text-secondary)"}:{},children:t},t))})]})]}),!A&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"var(--text-primary)"},children:"Scale Type"}),e.jsx("div",{className:"flex gap-2",children:["minor","major"].map(t=>e.jsxs("button",{onClick:()=>o(t),className:`flex-1 py-2 rounded-lg font-medium transition-all ${s===t?"btn-primary":""}`,style:s!==t?{backgroundColor:"var(--bg-tertiary)",color:"var(--text-secondary)"}:{},children:[t==="minor"?"Minor":"Major"," Pent."]},t))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",style:{color:"var(--text-primary)"},children:["Key (",s==="minor"?"Minor":"Major"," Pentatonic)"]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:se.map(t=>e.jsx("button",{onClick:()=>a(t),className:`px-3 py-2 rounded-lg font-medium transition-all min-w-[44px] ${n===t?"btn-primary":""}`,style:n!==t?{backgroundColor:"var(--bg-tertiary)",color:"var(--text-secondary)"}:{},children:t},t))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"var(--text-primary)"},children:"Shape / Box"}),e.jsx("div",{className:"flex gap-2",children:[0,1,2,3,4].map(t=>e.jsx("button",{onClick:()=>c(t),className:`flex-1 py-2 rounded-lg font-bold transition-all ${r===t?"btn-primary":""}`,style:r!==t?{backgroundColor:"var(--bg-tertiary)",color:"var(--text-secondary)"}:{},children:t+1},t))})]}),e.jsxs("div",{className:"p-4 rounded-lg",style:{backgroundColor:"rgba(59, 130, 246, 0.1)"},children:[e.jsx("h4",{className:"font-medium mb-2",style:{color:"var(--accent-primary)"},children:A?`Shape ${r+1} — ${n} ${k}`:`Shape ${r+1} — ${n} ${s==="minor"?"Minor":"Major"} Pentatonic`}),e.jsxs("div",{className:"text-sm space-y-1",style:{color:"var(--text-secondary)"},children:[e.jsxs("p",{children:["Starts from the ",e.jsx("strong",{children:ie})," (",G,") on the lowest string"]}),A?e.jsxs("p",{children:[s==="minor"?"Minor":"Major"," pentatonic + ",e.jsx("strong",{children:w.join(", ")}),P.length>0&&e.jsxs(e.Fragment,{children:[", replacing ",e.jsx("strong",{children:P.join(", ")})]})," ","= ",n," ",k]}):e.jsxs("p",{children:["Extends to: ",e.jsxs("strong",{children:[G," ",Z]})," by adding ",w.join(" and ")]}),s==="minor"&&e.jsx("p",{className:"mt-1",style:{color:"var(--text-muted)"},children:"Minor pentatonic = 1 b3 4 5 b7 — missing the 2nd and 6th degrees"}),s==="major"&&e.jsx("p",{className:"mt-1",style:{color:"var(--text-muted)"},children:"Major pentatonic = 1 2 3 5 6 — missing the 4th and 7th degrees"})]})]}),A&&w.length>0&&e.jsxs("div",{className:"p-4 rounded-lg",style:{backgroundColor:"var(--bg-tertiary)",border:"1px solid var(--accent-primary)"},children:[e.jsxs("h4",{className:"font-medium mb-2",style:{color:"var(--accent-primary)"},children:["Extension Notes for ",n," ",k]}),e.jsxs("div",{className:"text-sm space-y-1",style:{color:"var(--text-secondary)"},children:[e.jsxs("p",{children:[w.length," note",w.length!==1?"s":""," that distinguish ",k," from the ",s," pentatonic: ",e.jsx("strong",{children:w.join(", ")})]}),P.length>0&&e.jsxs("p",{children:["The pentatonic's ",e.jsx("strong",{children:P.join(", ")})," ",P.length===1?"is":"are"," not part of ",k," and ",P.length===1?"is":"are"," hidden from the display."]}),e.jsx("p",{children:"These are the same pitch classes in every shape — only their fretboard positions change as you move across shapes."})]})]}),i.id==="pentatonic-4"&&e.jsxs("div",{className:"p-4 rounded-lg",style:{backgroundColor:"var(--bg-tertiary)",border:"1px solid var(--accent-primary)"},children:[e.jsx("h4",{className:"font-medium mb-3",style:{color:"var(--accent-primary)"},children:"Shape → Mode Reference"}),e.jsx("div",{className:"grid grid-cols-1 gap-2 text-sm",style:{color:"var(--text-secondary)"},children:[0,1,2,3,4].map(t=>{const d=ae[Q[t]],x=V[t],l=r===t;return e.jsxs("button",{onClick:()=>c(t),className:"text-left p-2 rounded transition-all",style:{backgroundColor:l?"rgba(59, 130, 246, 0.15)":"transparent",color:l?"var(--accent-primary)":"var(--text-secondary)",fontWeight:l?"bold":"normal"},children:["Shape ",t+1," (",x,") → ",d]},t)})})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 items-center",children:[!A&&e.jsxs("label",{className:`flex items-center gap-2 ${B?"opacity-40 cursor-not-allowed":"cursor-pointer"}`,title:B?'Disable "Show All Shapes" to use this option':void 0,children:[e.jsx("input",{type:"checkbox",checked:I,onChange:t=>f(t.target.checked),disabled:B,className:"rounded"}),e.jsxs("span",{className:"text-sm",style:{color:"var(--text-primary)"},children:["Show Full Scale (+",w.join(", "),")"]})]}),!A&&e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:B,onChange:t=>{re(t.target.checked),t.target.checked&&f(!1)},className:"rounded"}),e.jsx("span",{className:"text-sm",style:{color:"var(--text-primary)"},children:"Show All Shapes"})]}),e.jsx(be,{})]}),e.jsx("div",{className:"card p-4",children:e.jsx(ge,{interactive:!0})}),e.jsxs("div",{className:"flex gap-3 flex-wrap",children:[e.jsx("button",{onClick:de,className:b?"btn-danger":"btn-success",children:b?"Stop Drone":"Play Drone"}),e.jsx("button",{onClick:me,disabled:K,className:"btn-secondary disabled:opacity-50",children:K?"Playing...":"Play Scale"})]}),e.jsxs("div",{className:"p-4 rounded-lg",style:{backgroundColor:"var(--bg-tertiary)"},children:[e.jsx("h4",{className:"font-medium mb-2",style:{color:"var(--text-primary)"},children:"Practice Tips"}),e.jsx("ul",{className:"text-sm space-y-1 list-disc list-inside",style:{color:"var(--text-secondary)"},children:A?e.jsxs(e.Fragment,{children:[e.jsxs("li",{children:["Cycle through all 5 shapes to see how ",w.join(", ")," appear in different positions"]}),e.jsx("li",{children:"The extension notes are always the same pitch classes — notice how their fretboard locations shift per shape"}),P.length>0&&e.jsxs("li",{children:["The pentatonic's ",P.join(", ")," ",P.length===1?"is":"are"," replaced in ",k," — practice hearing the difference"]}),e.jsx("li",{children:"Try switching between scales (e.g., Dorian vs Harmonic Minor) to see which notes change"}),e.jsxs("li",{children:["Use the drone to hear the color of ",k," over the root"]}),e.jsx("li",{children:"Each box connects to the next — the top notes of one box overlap with the bottom of the next"}),e.jsx("li",{children:"Practice improvising in each shape using the pentatonic backbone + the extension notes"})]}):e.jsxs(e.Fragment,{children:[e.jsx("li",{children:"Master each shape individually before connecting them"}),e.jsxs("li",{children:["Start on the ",R," string and play ascending, then descend back down"]}),e.jsx("li",{children:'Look for the "rectangle" — two adjacent strings where the minor 3rd intervals sit; the 2 extension notes always land here'}),e.jsx("li",{children:'Toggle "Show Full Scale" to see how adding 2 notes turns the pentatonic into a full mode'}),e.jsx("li",{children:m?"Practice alternating fingers (index-middle) for consistent tone":"Practice alternate picking — down-up-down-up through the shape"}),e.jsx("li",{children:"Try the same lick in all 5 shapes to build fretboard freedom"}),e.jsx("li",{children:"Each box connects to the next — the top notes of one box overlap with the bottom of the next"}),e.jsx("li",{children:"Use the drone to hear how pentatonic notes relate to the root"}),I&&e.jsxs("li",{children:["The faded notes (",w.join(" and "),") turn this shape into ",G," ",Z]})]})})]}),e.jsx(ve,{exerciseId:i.id,exerciseType:i.type})]})};export{_e as default,X as getPentatonicBox};
