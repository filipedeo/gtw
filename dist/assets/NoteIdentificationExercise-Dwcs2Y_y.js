import{u as L,r as o,i as W,g as G,n as K,N as U,a as E,p as v,j as e,F as _,b as B}from"./index-1OEwh6EN.js";import{u as J}from"./useExercise-CBo58W94.js";import"./tone-xN27a9Rt.js";const Z=({exercise:c})=>{const{stringCount:N,tuning:b,setHighlightedPositions:j,setRootNote:w,clearHighlights:h}=L(),{score:d,questionNumber:A,isActive:l,recordAnswer:F,scorePercentage:O}=J({exerciseId:c.id,totalQuestions:10}),[n,R]=o.useState(null),[y,T]=o.useState(""),[u,q]=o.useState(""),[m,I]=o.useState([]),[a,k]=o.useState(null),[x,S]=o.useState(null),[M,C]=o.useState(!1),[$,f]=o.useState([]);o.useEffect(()=>{const t=r=>{if(!l||a!==null)return;const s={1:0,2:1,3:2,4:3};if(r.key in s){const i=s[r.key];i<m.length&&(r.preventDefault(),P(m[i]))}};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[l,a,m]);const p=c.difficulty<=1?5:c.difficulty<=2?12:22,g=o.useCallback(async()=>{await W();const t=B(N,p,0),r=G(t,b),s=r.replace(/\d/,""),i=K(s),Q=U.filter(H=>!E(H,i)).sort(()=>Math.random()-.5).slice(0,3),z=[i,...Q].sort(()=>Math.random()-.5);R(t),T(i),q(r),I(z),k(null),S(null),C(!1),f([]),j([t]),w(null),setTimeout(()=>{v(r,{duration:1.5,velocity:.7})},300)},[N,b,p,j,w]);o.useEffect(()=>(l?g():(h(),f([])),()=>{h(),f([])}),[l,g,h]);const D=()=>{u&&v(u,{duration:1.5,velocity:.7})},P=t=>{if(a!==null||!l||!n)return;k(t);const r=E(t,y);S(r),C(!0),f([n]),F(r),v(u,{duration:1,velocity:.6}),setTimeout(()=>{d.total+1<10&&g()},2e3)};return l?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm",style:{color:"var(--text-secondary)"},children:["Question ",A," of 10"]}),e.jsxs("div",{className:"text-sm font-medium",style:{color:"var(--text-primary)"},children:["Score: ",d.correct,"/",d.total,d.total>0&&e.jsxs("span",{style:{color:"var(--text-muted)"},className:"ml-2",children:["(",O,"%)"]})]})]}),e.jsx("div",{className:"card p-4",children:e.jsx(_,{interactive:!1,hideNoteNames:!0,revealedPositions:$})}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg font-medium mb-2",style:{color:"var(--text-primary)"},children:"What note is highlighted on the fretboard?"}),e.jsxs("div",{className:"flex items-center justify-center gap-4",children:[n&&e.jsxs("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:["String ",n.string+1,", Fret ",n.fret]}),e.jsx("button",{onClick:D,className:"btn-secondary text-sm flex items-center gap-1",disabled:a!==null,children:"ðŸ”Š Play Again"})]})]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3 max-w-2xl mx-auto",role:"group","aria-label":"Answer options. Press 1, 2, 3, or 4 to select an answer",children:m.map((t,r)=>{let s={padding:"1rem 1.5rem",borderRadius:"0.5rem",fontWeight:"bold",fontSize:"1.125rem",transition:"all 0.2s",border:"none",cursor:a===null?"pointer":"default"};return a===null?(s.backgroundColor="var(--bg-tertiary)",s.color="var(--text-primary)"):t===y?(s.backgroundColor="var(--success)",s.color="white"):t===a?(s.backgroundColor="var(--error)",s.color="white"):(s.backgroundColor="var(--bg-tertiary)",s.color="var(--text-muted)",s.opacity=.5),e.jsxs("button",{onClick:()=>P(t),disabled:a!==null,style:s,className:"hover:opacity-90 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-blue-500","aria-label":`Option ${r+1}: ${t}. Press ${r+1} to select`,"aria-pressed":a===t,children:[e.jsxs("span",{className:"sr-only",children:[r+1,": "]}),t]},t)})}),e.jsxs("p",{className:"text-center text-xs",style:{color:"var(--text-muted)"},children:[e.jsx("span",{"aria-hidden":"true",children:"Tip: Press 1, 2, 3, or 4 to quickly select an answer"}),e.jsx("span",{className:"sr-only",children:"Use number keys 1 through 4 to select answers"})]}),M&&e.jsxs("div",{className:"text-center p-4 rounded-lg animate-fade-in",style:{backgroundColor:x?"rgba(16, 185, 129, 0.1)":"rgba(239, 68, 68, 0.1)"},role:"alert","aria-live":"assertive",children:[e.jsxs("p",{className:"font-medium text-lg",style:{color:x?"var(--success)":"var(--error)"},children:[e.jsx("span",{"aria-hidden":"true",children:x?"âœ“":"âœ—"}),x?" Correct!":` Incorrect. The answer was ${y}`]}),e.jsxs("p",{className:"text-sm mt-1",style:{color:"var(--text-muted)"},children:[u," - String ",n?n.string+1:"",", Fret ",n?.fret]})]})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{style:{color:"var(--text-secondary)"},className:"mb-4",children:'Click "Start Exercise" to begin identifying notes on the fretboard.'}),e.jsxs("div",{className:"flex justify-center gap-4 text-sm",style:{color:"var(--text-muted)"},children:[e.jsxs("span",{children:["Difficulty: ",c.difficulty,"/5"]}),e.jsx("span",{children:"|"}),e.jsxs("span",{children:["Frets: 0-",p]}),e.jsx("span",{children:"|"}),e.jsx("span",{children:"10 questions"})]})]})};export{Z as default};
//# sourceMappingURL=NoteIdentificationExercise-Dwcs2Y_y.js.map
