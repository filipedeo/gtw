import{u as de,c as me,d as he,r as f,l as I,n as pe,g as R,s as ee,j as e,F as fe,m as ue,i as te,f as xe,p as ge}from"./index-CrYEXAxW.js";import{a as C}from"./theoryEngine-B3dQahfx.js";import{D as je}from"./DisplayModeToggle-DtggWZSM.js";import{P as ye}from"./PracticeRating-PVheSIlz.js";import"./tone-BWNjRQgH.js";const oe=["C","Db","D","Eb","E","F","F#","G","Ab","A","Bb","B"],ne=["Ionian (Major)","Dorian","Phrygian","Lydian","Mixolydian","Aeolian (Natural Minor)","Locrian"],Ne=[5,0,1,2,4],ve=[0,1,2,4,5],be=["Root","b3","4","5","b7"],Me=["Root","2","3","5","6"],K=[{name:"aeolian",displayName:"Aeolian (Natural Minor)"},{name:"dorian",displayName:"Dorian"},{name:"phrygian",displayName:"Phrygian"}],G=[{name:"major",displayName:"Ionian (Major)"},{name:"lydian",displayName:"Lydian"},{name:"mixolydian",displayName:"Mixolydian"}],J=[{name:"blues",displayName:"Blues Scale"},{name:"harmonic minor",displayName:"Harmonic Minor"},{name:"melodic minor",displayName:"Melodic Minor (Jazz Minor)"}];function _(i){return i.map(p=>I(p).chroma).filter(p=>p!==void 0)}function z(i){return ue(i)||i}function Se(i,p,u){const b=_(C(i,p==="minor"?"minor pentatonic":"major pentatonic")),T=_(C(i,u));return b.filter(M=>!T.includes(M))}function U(i,p,u,j,b){const M=C(i,p==="minor"?"minor pentatonic":"major pentatonic");if(!M||M.length===0)return[];const w=_(M),O=w[0],v=[];for(let o=0;o<=22;o++){const n=R({string:0,fret:o},j),a=I(n).chroma;a!==void 0&&w.includes(a)&&v.push({fret:o,chroma:a})}const S=v.findIndex(o=>o.chroma===O);if(S===-1)return[];const D=S+u;if(D>=v.length)return[];let s=v[D].fret;s>12&&(s-=12);const m=[];for(let o=0;o<b;o++){const n=[];for(let l=0;l<=22;l++){const r=R({string:o,fret:l},j),y=I(r).chroma;y!==void 0&&w.includes(y)&&n.push(l)}let a=[],d=1/0;for(let l=0;l<n.length-1;l++){const r=[n[l],n[l+1]];if(r[0]>=s-1&&r[1]<=s+4){const y=Math.abs(r[0]-s);y<d&&(d=y,a=r)}}if(a.length===0)for(let l=0;l<n.length-1;l++){const r=[n[l],n[l+1]];if(r[1]-r[0]<=5){const y=(r[0]+r[1])/2,B=Math.abs(y-(s+1.5));B<d&&(d=B,a=r)}}a.forEach(l=>m.push({string:o,fret:l}))}return m}function Ce(i,p,u,j,b,T){if(i.length===0)return[];const M=u==="minor"?"minor pentatonic":"major pentatonic",w=T||(u==="minor"?"aeolian":"major"),O=_(C(p,M)),S=_(C(p,w)).filter(n=>!O.includes(n));if(S.length===0)return[];const D=i.map(n=>n.fret),s=Math.min(...D),m=Math.max(...D),o=[];for(let n=0;n<b;n++)for(let a=Math.max(0,s-1);a<=m+1;a++){const d=R({string:n,fret:a},j),l=I(d).chroma;l!==void 0&&S.includes(l)&&o.push({string:n,fret:a})}return o}const Te=({exercise:i})=>{const{stringCount:p,tuning:u,setHighlightedPositions:j,setSecondaryHighlightedPositions:b,setRootNote:T,clearHighlights:M}=de(),{droneConfig:w,setDroneConfig:O,isDroneActive:v,setDroneActive:S}=me(),{isActive:D}=he(),[s,m]=f.useState("A"),[o,n]=f.useState("minor"),[a,d]=f.useState(0),[l,r]=f.useState(!1),[y,B]=f.useState(!1),[$,W]=f.useState(!1),[N,X]=f.useState(null);f.useEffect(()=>{const t=i.id;t==="pentatonic-1"?(n("minor"),d(0),r(!1),m("A")):t==="pentatonic-minor-2"?(n("minor"),d(1),r(!1),m("A")):t==="pentatonic-minor-3"?(n("minor"),d(2),r(!1),m("A")):t==="pentatonic-minor-4"?(n("minor"),d(3),r(!1),m("A")):t==="pentatonic-minor-5"?(n("minor"),d(4),r(!1),m("A")):t==="pentatonic-major-1"?(n("major"),d(0),r(!1),m("C")):t==="pentatonic-major-2"?(n("major"),d(1),r(!1),m("C")):t==="pentatonic-major-3"?(n("major"),d(2),r(!1),m("C")):t==="pentatonic-major-4"?(n("major"),d(3),r(!1),m("C")):t==="pentatonic-major-5"?(n("major"),d(4),r(!1),m("C")):t==="pentatonic-4"?(n("minor"),d(0),r(!0),m("A")):t==="pentatonic-5"&&(n("minor"),d(0),r(!0),m("A"),X("aeolian"))},[i.id]),f.useEffect(()=>{i.id!=="pentatonic-5"||!N||(K.some(t=>t.name===N)||J.some(t=>t.name===N)?n("minor"):G.some(t=>t.name===N)&&n("major"))},[N,i.id]);const Y=o==="minor"?Ne:ve,q=o==="minor"?be:Me,Q=ne[Y[a]],se=q[a],ae=f.useCallback(t=>{const h=o==="minor"?"minor pentatonic":"major pentatonic",x=t||(o==="minor"?"aeolian":"major"),c=_(C(s,h));return C(s,x).filter(F=>{const L=I(F).chroma;return L!==void 0&&!c.includes(L)}).map(z)},[s,o]),re=f.useCallback(()=>{const h=C(s,o==="minor"?"minor pentatonic":"major pentatonic");return a<h.length?z(h[a]):s},[s,o,a]),V=f.useCallback(()=>{if(!D)return;const t=U(s,o,a,u,p);if(T(pe(s)),y){const h=[],x=[];for(let c=0;c<5;c++){const g=U(s,o,c,u,p);c===a?x.push(...g):h.push(...g)}j(x),b(h)}else if(l){const h=i.id==="pentatonic-5"&&N||void 0;if(h){const c=Se(s,o,h);if(c.length>0){const g=t.filter(F=>{const L=R(F,u),Z=I(L).chroma;return Z===void 0||!c.includes(Z)});j(g)}else j(t)}else j(t);const x=Ce(t,s,o,u,p,h);b(x)}else j(t),b([])},[D,s,o,a,l,y,u,p,N,i.id,j,b,T]);f.useEffect(()=>{V()},[V]),f.useEffect(()=>()=>{M(),v&&(ee(),S(!1))},[M,v,S]);const ie=async()=>{await te(),v?(ee(),S(!1)):(O({note:s,octave:2}),xe({note:s,octave:2,volume:w.volume,waveform:w.waveform}),S(!0))},le=async()=>{if($)return;await te(),W(!0);const h=[...U(s,o,a,u,p)].sort((c,g)=>c.string!==g.string?c.string-g.string:c.fret-g.fret),x=.25;for(let c=0;c<h.length;c++){const g=R(h[c],u);ge(g,{duration:.4,velocity:.7,delay:c*x})}setTimeout(()=>W(!1),h.length*x*1e3+500)},ce=f.useCallback(t=>{if(!t)return[];const x=C(s,o==="minor"?"minor pentatonic":"major pentatonic"),c=_(C(s,t));return x.filter(g=>{const F=I(g).chroma;return F!==void 0&&!c.includes(F)}).map(z)},[s,o]),E=ae(i.id==="pentatonic-5"&&N||void 0),P=ce(i.id==="pentatonic-5"&&N||void 0),H=re(),k=i.id==="pentatonic-5",A=[...K,...G,...J].find(t=>t.name===N)?.displayName??N??"";return e.jsxs("div",{className:"space-y-6",children:[k&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"var(--text-primary)"},children:"Target Mode"}),e.jsxs("select",{value:N||"",onChange:t=>X(t.target.value),className:"w-full px-3 py-2 rounded-lg",style:{backgroundColor:"var(--bg-primary)",color:"var(--text-primary)",border:"1px solid var(--border-color)"},children:[e.jsx("optgroup",{label:"Minor Modes (from minor pentatonic)",children:K.map(t=>e.jsx("option",{value:t.name,children:t.displayName},t.name))}),e.jsx("optgroup",{label:"Major Modes (from major pentatonic)",children:G.map(t=>e.jsx("option",{value:t.name,children:t.displayName},t.name))}),e.jsx("optgroup",{label:"Other Scales (from minor pentatonic)",children:J.map(t=>e.jsx("option",{value:t.name,children:t.displayName},t.name))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"var(--text-primary)"},children:"Key"}),e.jsx("select",{value:s,onChange:t=>m(t.target.value),className:"w-full px-3 py-2 rounded-lg",style:{backgroundColor:"var(--bg-primary)",color:"var(--text-primary)",border:"1px solid var(--border-color)"},children:oe.map(t=>e.jsxs("option",{value:t,children:[t," ",A]},t))})]})]}),!k&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"var(--text-primary)"},children:"Scale Type"}),e.jsx("div",{className:"flex gap-2",children:["minor","major"].map(t=>e.jsxs("button",{onClick:()=>n(t),className:`flex-1 py-2 rounded-lg font-medium transition-all ${o===t?"btn-primary":""}`,style:o!==t?{backgroundColor:"var(--bg-tertiary)",color:"var(--text-secondary)"}:{},children:[t==="minor"?"Minor":"Major"," Pent."]},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"var(--text-primary)"},children:"Key"}),e.jsx("select",{value:s,onChange:t=>m(t.target.value),className:"w-full px-3 py-2 rounded-lg",style:{backgroundColor:"var(--bg-primary)",color:"var(--text-primary)",border:"1px solid var(--border-color)"},children:oe.map(t=>e.jsxs("option",{value:t,children:[t," ",o==="minor"?"Minor":"Major"," Pentatonic"]},t))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"var(--text-primary)"},children:"Shape / Box"}),e.jsx("div",{className:"flex gap-2",children:[0,1,2,3,4].map(t=>e.jsx("button",{onClick:()=>d(t),className:`flex-1 py-2 rounded-lg font-bold transition-all ${a===t?"btn-primary":""}`,style:a!==t?{backgroundColor:"var(--bg-tertiary)",color:"var(--text-secondary)"}:{},children:t+1},t))})]}),e.jsxs("div",{className:"p-4 rounded-lg",style:{backgroundColor:"rgba(59, 130, 246, 0.1)"},children:[e.jsx("h4",{className:"font-medium mb-2",style:{color:"var(--accent-primary)"},children:k?`Shape ${a+1} — ${s} ${A}`:`Shape ${a+1} — ${s} ${o==="minor"?"Minor":"Major"} Pentatonic`}),e.jsxs("div",{className:"text-sm space-y-1",style:{color:"var(--text-secondary)"},children:[e.jsxs("p",{children:["Starts from the ",e.jsx("strong",{children:se})," (",H,") on the lowest string"]}),k?e.jsxs("p",{children:[o==="minor"?"Minor":"Major"," pentatonic + ",e.jsx("strong",{children:E.join(", ")}),P.length>0&&e.jsxs(e.Fragment,{children:[", replacing ",e.jsx("strong",{children:P.join(", ")})]})," ","= ",s," ",A]}):e.jsxs("p",{children:["Extends to: ",e.jsxs("strong",{children:[H," ",Q]})," by adding ",E.join(" and ")]}),o==="minor"&&e.jsx("p",{className:"mt-1",style:{color:"var(--text-muted)"},children:"Minor pentatonic = 1 b3 4 5 b7 — missing the 2nd and 6th degrees"}),o==="major"&&e.jsx("p",{className:"mt-1",style:{color:"var(--text-muted)"},children:"Major pentatonic = 1 2 3 5 6 — missing the 4th and 7th degrees"})]})]}),k&&E.length>0&&e.jsxs("div",{className:"p-4 rounded-lg",style:{backgroundColor:"var(--bg-tertiary)",border:"1px solid var(--accent-primary)"},children:[e.jsxs("h4",{className:"font-medium mb-2",style:{color:"var(--accent-primary)"},children:["Extension Notes for ",s," ",A]}),e.jsxs("div",{className:"text-sm space-y-1",style:{color:"var(--text-secondary)"},children:[e.jsxs("p",{children:[E.length," note",E.length!==1?"s":""," that distinguish ",A," from the ",o," pentatonic: ",e.jsx("strong",{children:E.join(", ")})]}),P.length>0&&e.jsxs("p",{children:["The pentatonic's ",e.jsx("strong",{children:P.join(", ")})," ",P.length===1?"is":"are"," not part of ",A," and ",P.length===1?"is":"are"," hidden from the display."]}),e.jsx("p",{children:"These are the same pitch classes in every shape — only their fretboard positions change as you move across shapes."})]})]}),i.id==="pentatonic-4"&&e.jsxs("div",{className:"p-4 rounded-lg",style:{backgroundColor:"var(--bg-tertiary)",border:"1px solid var(--accent-primary)"},children:[e.jsx("h4",{className:"font-medium mb-3",style:{color:"var(--accent-primary)"},children:"Shape → Mode Reference"}),e.jsx("div",{className:"grid grid-cols-1 gap-2 text-sm",style:{color:"var(--text-secondary)"},children:[0,1,2,3,4].map(t=>{const h=ne[Y[t]],x=q[t],c=a===t;return e.jsxs("button",{onClick:()=>d(t),className:"text-left p-2 rounded transition-all",style:{backgroundColor:c?"rgba(59, 130, 246, 0.15)":"transparent",color:c?"var(--accent-primary)":"var(--text-secondary)",fontWeight:c?"bold":"normal"},children:["Shape ",t+1," (",x,") → ",h]},t)})})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 items-center",children:[!k&&!y&&e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:l,onChange:t=>r(t.target.checked),className:"rounded"}),e.jsxs("span",{className:"text-sm",style:{color:"var(--text-primary)"},children:["Show Full Scale (+",E.join(", "),")"]})]}),!k&&e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:y,onChange:t=>{B(t.target.checked),t.target.checked&&r(!1)},className:"rounded"}),e.jsx("span",{className:"text-sm",style:{color:"var(--text-primary)"},children:"Show All Shapes"})]}),e.jsx(je,{})]}),e.jsx("div",{className:"card p-4",children:e.jsx(fe,{interactive:!0})}),e.jsxs("div",{className:"flex gap-3 flex-wrap",children:[e.jsx("button",{onClick:ie,className:v?"btn-danger":"btn-success",children:v?"Stop Drone":"Play Drone"}),e.jsx("button",{onClick:le,disabled:$,className:"btn-secondary disabled:opacity-50",children:$?"Playing...":"Play Scale"})]}),e.jsxs("div",{className:"p-4 rounded-lg",style:{backgroundColor:"var(--bg-tertiary)"},children:[e.jsx("h4",{className:"font-medium mb-2",style:{color:"var(--text-primary)"},children:"Practice Tips"}),e.jsx("ul",{className:"text-sm space-y-1 list-disc list-inside",style:{color:"var(--text-secondary)"},children:k?e.jsxs(e.Fragment,{children:[e.jsxs("li",{children:["Cycle through all 5 shapes to see how ",E.join(", ")," appear in different positions"]}),e.jsx("li",{children:"The extension notes are always the same pitch classes — notice how their fretboard locations shift per shape"}),P.length>0&&e.jsxs("li",{children:["The pentatonic's ",P.join(", ")," ",P.length===1?"is":"are"," replaced in ",A," — practice hearing the difference"]}),e.jsx("li",{children:"Try switching between scales (e.g., Dorian vs Harmonic Minor) to see which notes change"}),e.jsxs("li",{children:["Use the drone to hear the color of ",A," over the root"]}),e.jsx("li",{children:"Each box connects to the next — the top notes of one box overlap with the bottom of the next"}),e.jsx("li",{children:"Practice improvising in each shape using the pentatonic backbone + the extension notes"})]}):e.jsxs(e.Fragment,{children:[e.jsx("li",{children:"Master each shape individually before connecting them"}),e.jsx("li",{children:'Look for the "rectangle" — two adjacent strings where the minor 3rd intervals sit; the 2 extension notes always land here'}),e.jsx("li",{children:'Toggle "Show Full Scale" to see how adding 2 notes turns the pentatonic into a full mode'}),e.jsx("li",{children:"Try the same lick in all 5 shapes to build fretboard freedom"}),e.jsx("li",{children:"Each box connects to the next — the top notes of one box overlap with the bottom of the next"}),e.jsx("li",{children:"Use the drone to hear how pentatonic notes relate to the root"}),l&&e.jsxs("li",{children:["The faded notes (",E.join(" and "),") turn this shape into ",H," ",Q]})]})})]}),e.jsx(ye,{exerciseId:i.id,exerciseType:i.type})]})};export{Te as default,U as getPentatonicBox};
