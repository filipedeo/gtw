import{u as V,r as n,i as z,g as j,p as i,j as e,F as X,b as Y}from"./index-DtFSbDgp.js";import{u as Z}from"./useExercise-C5D822MC.js";import"./tone-xN27a9Rt.js";const M=[{name:"Minor 2nd",short:"m2",semitones:1,song:'"Jaws" theme'},{name:"Major 2nd",short:"M2",semitones:2,song:'"Happy Birthday" (first two notes)'},{name:"Minor 3rd",short:"m3",semitones:3,song:'"Greensleeves" (first two notes)'},{name:"Major 3rd",short:"M3",semitones:4,song:'"Kumbaya" (first two notes)'},{name:"Perfect 4th",short:"P4",semitones:5,song:'"Here Comes the Bride"'},{name:"Tritone",short:"TT",semitones:6,song:'"The Simpsons" theme'},{name:"Perfect 5th",short:"P5",semitones:7,song:'"Star Wars" theme'},{name:"Minor 6th",short:"m6",semitones:8,song:'"The Entertainer"'},{name:"Major 6th",short:"M6",semitones:9,song:'"My Bonnie Lies Over the Ocean"'},{name:"Minor 7th",short:"m7",semitones:10,song:'"Somewhere" (West Side Story)'},{name:"Major 7th",short:"M7",semitones:11,song:'"Take On Me" (first two notes)'},{name:"Octave",short:"P8",semitones:12,song:'"Somewhere Over the Rainbow"'}];function _(a){return a<=1?M.filter(l=>["P4","P5"].includes(l.short)):a<=2?M.filter(l=>["m3","M3","P4","P5"].includes(l.short)):M}const re=({exercise:a})=>{const{stringCount:l,tuning:h,setHighlightedPositions:S,clearHighlights:b}=V(),{score:x,questionNumber:H,isActive:c,recordAnswer:L,scorePercentage:W}=Z({exerciseId:a.id,totalQuestions:10}),[k,T]=n.useState(null),[C,B]=n.useState(null),[d,Q]=n.useState(null),[y,q]=n.useState([]),[o,A]=n.useState(null),[v,E]=n.useState(null),[G,I]=n.useState(!1),[D,K]=n.useState("ascending");n.useEffect(()=>{const t=r=>{if(!c||o!==null)return;const s={1:0,2:1,3:2,4:3};if(r.key in s){const u=s[r.key];u<y.length&&(r.preventDefault(),R(y[u].short))}};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[c,o,y]);const m=_(a.difficulty),N=n.useCallback(async()=>{await z();const t=m[Math.floor(Math.random()*m.length)],r=a.difficulty<=1?7:12,s=Y(l,r,0),u=Math.random()>.5?"ascending":"descending",w=u==="ascending"?s.fret+t.semitones:s.fret-t.semitones;let g=w,f=u;if((w<0||w>22)&&(f=u==="ascending"?"descending":"ascending",g=f==="ascending"?s.fret+t.semitones:s.fret-t.semitones),g<0||g>22){const p={...s,fret:Math.min(s.fret,10)};g=p.fret+t.semitones,f="ascending",T(p)}else T(s);const P={string:s.string,fret:g},J=m.filter(p=>p.short!==t.short).sort(()=>Math.random()-.5).slice(0,3),U=[t,...J].sort(()=>Math.random()-.5);B(P),Q(t),q(U),A(null),E(null),I(!1),K(f),S([s,P]);const F=j(s,h),$=j(P,h);setTimeout(()=>{f==="ascending"?(i(F,{duration:.8,velocity:.7}),setTimeout(()=>i($,{duration:.8,velocity:.7}),600)):(i($,{duration:.8,velocity:.7}),setTimeout(()=>i(F,{duration:.8,velocity:.7}),600))},300)},[l,h,a.difficulty,m,S]);n.useEffect(()=>(c?N():b(),()=>{b()}),[c,N,b]);const O=()=>{if(!k||!C)return;const t=j(k,h),r=j(C,h);D==="ascending"?(i(t,{duration:.8,velocity:.7}),setTimeout(()=>i(r,{duration:.8,velocity:.7}),600)):(i(r,{duration:.8,velocity:.7}),setTimeout(()=>i(t,{duration:.8,velocity:.7}),600))},R=t=>{if(o!==null||!c||!d)return;A(t);const r=t===d.short;E(r),I(!0),L(r),O(),setTimeout(()=>{x.total+1<10&&N()},2500)};return c?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm",style:{color:"var(--text-secondary)"},children:["Question ",H," of 10"]}),e.jsxs("div",{className:"text-sm font-medium",style:{color:"var(--text-primary)"},children:["Score: ",x.correct,"/",x.total,x.total>0&&e.jsxs("span",{style:{color:"var(--text-muted)"},className:"ml-2",children:["(",W,"%)"]})]})]}),e.jsx("div",{className:"card p-4",children:e.jsx(X,{interactive:!1})}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg font-medium mb-2",style:{color:"var(--text-primary)"},children:"What interval is being played?"}),e.jsxs("div",{className:"flex items-center justify-center gap-4",children:[e.jsxs("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:["Direction: ",D==="ascending"?"â†‘ Ascending":"â†“ Descending"]}),e.jsx("button",{onClick:O,className:"btn-secondary text-sm flex items-center gap-1",disabled:o!==null,children:"ðŸ”Š Play Again"})]})]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3 max-w-2xl mx-auto",role:"group","aria-label":"Answer options. Press 1, 2, 3, or 4 to select an answer",children:y.map((t,r)=>{let s={padding:"1rem",borderRadius:"0.5rem",fontWeight:"bold",transition:"all 0.2s",border:"none",cursor:o===null?"pointer":"default"};return o===null?(s.backgroundColor="var(--bg-tertiary)",s.color="var(--text-primary)"):t.short===d?.short?(s.backgroundColor="var(--success)",s.color="white"):t.short===o?(s.backgroundColor="var(--error)",s.color="white"):(s.backgroundColor="var(--bg-tertiary)",s.color="var(--text-muted)",s.opacity=.5),e.jsxs("button",{onClick:()=>R(t.short),disabled:o!==null,style:s,className:"hover:opacity-90 flex flex-col items-center focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-blue-500","aria-label":`Option ${r+1}: ${t.name}, ${t.semitones} semitones. Press ${r+1} to select`,"aria-pressed":o===t.short,children:[e.jsxs("span",{className:"sr-only",children:[r+1,": "]}),e.jsx("span",{className:"text-lg",children:t.short}),e.jsx("span",{className:"text-xs opacity-75",children:t.name})]},t.short)})}),e.jsxs("p",{className:"text-center text-xs",style:{color:"var(--text-muted)"},children:[e.jsx("span",{"aria-hidden":"true",children:"Tip: Press 1, 2, 3, or 4 to quickly select an answer"}),e.jsx("span",{className:"sr-only",children:"Use number keys 1 through 4 to select answers"})]}),G&&d&&e.jsxs("div",{className:"text-center p-4 rounded-lg animate-fade-in",style:{backgroundColor:v?"rgba(16, 185, 129, 0.1)":"rgba(239, 68, 68, 0.1)"},role:"alert","aria-live":"assertive",children:[e.jsxs("p",{className:"font-medium text-lg",style:{color:v?"var(--success)":"var(--error)"},children:[e.jsx("span",{"aria-hidden":"true",children:v?"âœ“":"âœ—"}),v?" Correct!":` Incorrect. The answer was ${d.name}`]}),e.jsxs("p",{className:"text-sm mt-2",style:{color:"var(--text-secondary)"},children:["Song reference: ",d.song]})]}),e.jsxs("div",{className:"p-4 rounded-lg",style:{backgroundColor:"var(--bg-tertiary)"},children:[e.jsx("h4",{className:"font-medium mb-2",style:{color:"var(--text-primary)"},children:"Interval Reference"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 text-sm",children:m.map(t=>e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{style:{color:"var(--text-secondary)"},children:[t.short,":"]}),e.jsxs("span",{style:{color:"var(--text-muted)"},children:[t.semitones," semitones"]})]},t.short))})]})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{style:{color:"var(--text-secondary)"},className:"mb-4",children:'Click "Start Exercise" to begin interval recognition training.'}),e.jsxs("div",{className:"flex justify-center gap-4 text-sm",style:{color:"var(--text-muted)"},children:[e.jsxs("span",{children:["Difficulty: ",a.difficulty,"/5"]}),e.jsx("span",{children:"|"}),e.jsxs("span",{children:["Intervals: ",m.map(t=>t.short).join(", ")]})]})]})};export{re as default};
//# sourceMappingURL=IntervalRecognitionExercise-DFY-NaUq.js.map
