import{u as H,c as z,d as O,r as m,n as w,s as k,j as e,F as R,g as I,i as A,f as U,p as Y}from"./index-Cng5Xql7.js";import{M as C,g as q}from"./theoryEngine-DlHvYik2.js";import{D as J}from"./DisplayModeToggle-Bjev7L8J.js";import"./tone-xN27a9Rt.js";const L=["C","Db","D","Eb","E","F","F#","G","Ab","A","Bb","B"];function E(p,h,g,N,v){const f=q(w(p),h);if(!f||f.length===0)return[];const S=f.map(r=>w(r)),j=[];let b=v;for(let r=0;r<N;r++){const l=[];for(let s=0;s<=22;s++){const x=I({string:r,fret:s},g),o=w(x.replace(/\d/,""));S.includes(o)&&l.push(s)}let c=[],n=1/0;for(let s=0;s<=l.length-3;s++){const a=[l[s],l[s+1],l[s+2]];if(a[2]-a[0]<=5){const x=(a[0]+a[2])/2,o=Math.abs(x-b-2);o<n&&(n=o,c=a)}}c.length===3&&(c.forEach(s=>j.push({string:r,fret:s})),b=Math.max(b,c[0]))}return j}const Z=({exercise:p})=>{const{stringCount:h,tuning:g,setHighlightedPositions:N,setSecondaryHighlightedPositions:v,setRootNote:f,clearHighlights:S}=H(),{droneConfig:j,setDroneConfig:b,isDroneActive:r,setDroneActive:l}=z(),{isActive:c}=O(),[n,s]=m.useState("C"),[a,x]=m.useState(0),[o,T]=m.useState(0),[D,F]=m.useState(!1);m.useEffect(()=>{p.id==="three-nps-1"?x(0):p.id==="three-nps-2"&&x(1)},[p.id]);const y=C[a],M=m.useCallback(()=>{if(!c)return;const t=E(n,y.name,g,h,o);if(N(t),f(w(n)),p.id==="three-nps-3"){const d=(a+1)%C.length,P=C[d],i=o+2,u=E(n,P.name,g,h,i);v(u)}else v([])},[c,n,y,a,g,h,o,p.id,N,v,f]);m.useEffect(()=>{M()},[M]),m.useEffect(()=>()=>{S(),r&&(k(),l(!1))},[S,r,l]);const K=async()=>{await A(),r?(k(),l(!1)):(b({note:n,octave:2}),U({note:n,octave:2,volume:j.volume,waveform:j.waveform}),l(!0))},B=async()=>{if(D)return;await A(),F(!0);const d=[...E(n,y.name,g,h,o)].sort((i,u)=>i.string!==u.string?i.string-u.string:i.fret-u.fret),P=.2;for(let i=0;i<d.length;i++){const u=d[i],G=I(u,g);Y(G,{duration:.4,velocity:.7,delay:i*P})}setTimeout(()=>{F(!1)},d.length*P*1e3+500)};return c?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"var(--text-primary)"},children:"Mode / Pattern"}),e.jsx("select",{value:a,onChange:t=>x(parseInt(t.target.value)),className:"w-full px-3 py-2 rounded-lg",style:{backgroundColor:"var(--bg-primary)",color:"var(--text-primary)",border:"1px solid var(--border-color)"},children:C.map((t,d)=>e.jsxs("option",{value:d,children:["Pattern ",d+1," - ",t.displayName]},t.name))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"var(--text-primary)"},children:"Key"}),e.jsx("select",{value:n,onChange:t=>s(t.target.value),className:"w-full px-3 py-2 rounded-lg",style:{backgroundColor:"var(--bg-primary)",color:"var(--text-primary)",border:"1px solid var(--border-color)"},children:L.map(t=>e.jsx("option",{value:t,children:t},t))})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",style:{color:"var(--text-primary)"},children:["Starting Fret Position: ",o]}),e.jsx("input",{type:"range",min:0,max:12,value:o,onChange:t=>T(parseInt(t.target.value)),className:"w-full"}),e.jsxs("div",{className:"flex justify-between text-xs",style:{color:"var(--text-muted)"},children:[e.jsx("span",{children:"Open"}),e.jsx("span",{children:"12th Fret"})]})]}),e.jsxs("div",{className:"p-4 rounded-lg",style:{backgroundColor:"rgba(59, 130, 246, 0.1)"},children:[e.jsxs("h4",{className:"font-medium mb-2",style:{color:"var(--accent-primary)"},children:["Pattern ",a+1," - ",y.displayName," (",n,")"]}),e.jsxs("p",{className:"text-sm",style:{color:"var(--text-secondary)"},children:["Characteristic note: ",e.jsx("strong",{children:y.characteristicNote})," ","â€”"," ","3 notes per string starting near fret ",o,".",h===7&&" Includes low B string for 7-string coverage."]})]}),e.jsx("div",{className:"flex items-center justify-between",children:e.jsx(J,{})}),e.jsx("div",{className:"card p-4",children:e.jsx(R,{interactive:!0})}),e.jsxs("div",{className:"flex gap-3 flex-wrap",children:[e.jsx("button",{onClick:K,className:r?"btn-danger":"btn-success",children:r?"Stop Drone":"Play Drone"}),e.jsx("button",{onClick:B,disabled:D,className:"btn-secondary disabled:opacity-50",children:D?"Playing...":"Play Scale"})]}),e.jsxs("div",{className:"p-4 rounded-lg",style:{backgroundColor:"var(--bg-tertiary)"},children:[e.jsx("h4",{className:"font-medium mb-2",style:{color:"var(--text-primary)"},children:"Practice Tips"}),e.jsxs("ul",{className:"text-sm space-y-1 list-disc list-inside",style:{color:"var(--text-secondary)"},children:[e.jsx("li",{children:"Every string gets exactly 3 notes - great for even alternate picking"}),e.jsx("li",{children:"Practice ascending and descending with strict alternate picking"}),e.jsx("li",{children:"Try legato (hammer-ons ascending, pull-offs descending) for smooth lines"}),e.jsx("li",{children:"Start slow with a metronome - increase speed only when clean"}),e.jsx("li",{children:"Use the drone to hear how each note relates to the tonal center"}),e.jsx("li",{children:"Connect adjacent patterns by sliding between them"})]})]})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsxs("p",{style:{color:"var(--text-secondary)"},className:"mb-4",children:['Click "Start Exercise" to explore the ',y.displayName," 3NPS pattern."]}),e.jsx("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:"Three notes per string for efficient linear playing, legato, and speed."})]})};export{Z as default};
