{"version":3,"file":"EarTrainingExercise-XPgqIyrc.js","sources":["../../src/components/EarTrainingExercise.tsx"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport { Exercise } from '../types/exercise';\nimport { useExercise } from '../hooks/useExercise';\nimport { playChord, playNote, initAudio } from '../lib/audioEngine';\n\ninterface EarTrainingExerciseProps {\n  exercise: Exercise;\n}\n\nconst KEYS = ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'];\n\n// Chord quality definitions\nconst CHORD_QUALITIES = {\n  basic: [\n    { name: 'Major', intervals: [0, 4, 7], description: 'Bright, happy' },\n    { name: 'Minor', intervals: [0, 3, 7], description: 'Dark, sad' },\n  ],\n  seventh: [\n    { name: 'Major 7th', intervals: [0, 4, 7, 11], description: 'Dreamy, jazzy' },\n    { name: 'Minor 7th', intervals: [0, 3, 7, 10], description: 'Mellow, smooth' },\n    { name: 'Dominant 7th', intervals: [0, 4, 7, 10], description: 'Tense, wants to resolve' },\n  ],\n};\n\n// Scale degree names\nconst SCALE_DEGREES = ['1', '2', '3', '4', '5', '6', '7'];\n\ntype ExerciseMode = 'chord-basic' | 'chord-seventh' | 'scale-degree';\n\nconst EarTrainingExercise: React.FC<EarTrainingExerciseProps> = ({ exercise }) => {\n  const { score, questionNumber, isActive, recordAnswer, scorePercentage } = useExercise({\n    exerciseId: exercise.id,\n    totalQuestions: 10,\n  });\n  \n  const [mode, setMode] = useState<ExerciseMode>('chord-basic');\n  const [currentKey, setCurrentKey] = useState('C');\n  const [correctAnswer, setCorrectAnswer] = useState<string>('');\n  const [options, setOptions] = useState<string[]>([]);\n  const [selectedAnswer, setSelectedAnswer] = useState<string | null>(null);\n  const [isCorrect, setIsCorrect] = useState<boolean | null>(null);\n  const [showFeedback, setShowFeedback] = useState(false);\n  const [currentChordNotes, setCurrentChordNotes] = useState<string[]>([]);\n  const [currentScaleNote, setCurrentScaleNote] = useState<string>('');\n\n  // Keyboard shortcut handler for answer selection (1, 2, 3, 4, etc. keys)\n  useEffect(() => {\n    const handleKeyDown = (e: KeyboardEvent) => {\n      if (!isActive || selectedAnswer !== null) return;\n      \n      const keyMap: { [key: string]: number } = {\n        '1': 0,\n        '2': 1,\n        '3': 2,\n        '4': 3,\n        '5': 4,\n        '6': 5,\n        '7': 6,\n      };\n      \n      if (e.key in keyMap) {\n        const index = keyMap[e.key];\n        if (index < options.length) {\n          e.preventDefault();\n          handleAnswer(options[index]);\n        }\n      }\n    };\n    \n    window.addEventListener('keydown', handleKeyDown);\n    return () => window.removeEventListener('keydown', handleKeyDown);\n  }, [isActive, selectedAnswer, options]);\n\n  // Determine mode based on exercise\n  useEffect(() => {\n    if (exercise.id.includes('ear-1')) setMode('chord-basic');\n    else if (exercise.id.includes('ear-2')) setMode('chord-seventh');\n    else if (exercise.id.includes('ear-3')) setMode('scale-degree');\n  }, [exercise.id]);\n\n  const generateChordNotes = useCallback((rootNote: string, intervals: number[]): string[] => {\n    const rootIndex = KEYS.indexOf(rootNote.replace(/\\d/, ''));\n    const octave = 3;\n    \n    return intervals.map((interval, idx) => {\n      const noteIndex = (rootIndex + interval) % 12;\n      const noteOctave = octave + Math.floor((rootIndex + interval) / 12);\n      return `${KEYS[noteIndex]}${noteOctave + (idx > 2 ? 1 : 0)}`;\n    });\n  }, []);\n\n  const generateQuestion = useCallback(async () => {\n    await initAudio();\n    \n    // Pick a random key\n    const key = KEYS[Math.floor(Math.random() * KEYS.length)];\n    setCurrentKey(key);\n    \n    if (mode === 'chord-basic') {\n      const qualities = CHORD_QUALITIES.basic;\n      const quality = qualities[Math.floor(Math.random() * qualities.length)];\n      const notes = generateChordNotes(key, quality.intervals);\n      \n      setCorrectAnswer(quality.name);\n      setOptions(qualities.map(q => q.name).sort(() => Math.random() - 0.5));\n      setCurrentChordNotes(notes);\n      \n      // Play the chord\n      setTimeout(() => playChord(notes, { duration: 2, velocity: 0.6 }), 300);\n      \n    } else if (mode === 'chord-seventh') {\n      const qualities = CHORD_QUALITIES.seventh;\n      const quality = qualities[Math.floor(Math.random() * qualities.length)];\n      const notes = generateChordNotes(key, quality.intervals);\n      \n      setCorrectAnswer(quality.name);\n      setOptions(qualities.map(q => q.name).sort(() => Math.random() - 0.5));\n      setCurrentChordNotes(notes);\n      \n      setTimeout(() => playChord(notes, { duration: 2, velocity: 0.6 }), 300);\n      \n    } else if (mode === 'scale-degree') {\n      // First establish the key with a I chord\n      const tonicChord = generateChordNotes(key, [0, 4, 7]);\n      \n      // Pick a random scale degree\n      const degreeIndex = Math.floor(Math.random() * 7);\n      const degree = SCALE_DEGREES[degreeIndex];\n      \n      // Major scale intervals\n      const majorScaleIntervals = [0, 2, 4, 5, 7, 9, 11];\n      const noteInterval = majorScaleIntervals[degreeIndex];\n      const noteIndex = (KEYS.indexOf(key) + noteInterval) % 12;\n      const note = `${KEYS[noteIndex]}4`;\n      \n      setCorrectAnswer(degree);\n      setOptions(SCALE_DEGREES.sort(() => Math.random() - 0.5));\n      setCurrentChordNotes(tonicChord);\n      setCurrentScaleNote(note);\n      \n      // Play tonic chord, then the note\n      setTimeout(() => {\n        playChord(tonicChord, { duration: 1.5, velocity: 0.5 });\n        setTimeout(() => playNote(note, { duration: 1.5, velocity: 0.7 }), 1800);\n      }, 300);\n    }\n    \n    setSelectedAnswer(null);\n    setIsCorrect(null);\n    setShowFeedback(false);\n  }, [mode, generateChordNotes]);\n\n  useEffect(() => {\n    if (isActive) {\n      generateQuestion();\n    }\n  }, [isActive, generateQuestion]);\n\n  const handlePlayAgain = async () => {\n    await initAudio();\n    \n    if (mode === 'scale-degree') {\n      playChord(currentChordNotes, { duration: 1.5, velocity: 0.5 });\n      setTimeout(() => playNote(currentScaleNote, { duration: 1.5, velocity: 0.7 }), 1800);\n    } else {\n      playChord(currentChordNotes, { duration: 2, velocity: 0.6 });\n    }\n  };\n\n  const handleAnswer = (answer: string) => {\n    if (selectedAnswer !== null || !isActive) return;\n    \n    setSelectedAnswer(answer);\n    const correct = answer === correctAnswer;\n    setIsCorrect(correct);\n    setShowFeedback(true);\n    \n    // Record answer using the hook (handles scoring, completion, and progress tracking)\n    recordAnswer(correct);\n    \n    // Play again to reinforce\n    handlePlayAgain();\n    \n    // Move to next question after delay (hook handles completion check)\n    setTimeout(() => {\n      if (score.total + 1 < 10) {\n        generateQuestion();\n      }\n    }, 2500);\n  };\n\n  const getQuestionText = () => {\n    switch (mode) {\n      case 'chord-basic':\n        return 'Is this chord Major or Minor?';\n      case 'chord-seventh':\n        return 'What type of 7th chord is this?';\n      case 'scale-degree':\n        return `In the key of ${currentKey}, what scale degree is this note?`;\n      default:\n        return 'Listen and identify:';\n    }\n  };\n\n  const getHint = () => {\n    if (mode === 'chord-basic') {\n      return CHORD_QUALITIES.basic.find(q => q.name === correctAnswer)?.description;\n    } else if (mode === 'chord-seventh') {\n      return CHORD_QUALITIES.seventh.find(q => q.name === correctAnswer)?.description;\n    }\n    return null;\n  };\n\n  if (!isActive) {\n    return (\n      <div className=\"text-center py-8\">\n        <p style={{ color: 'var(--text-secondary)' }} className=\"mb-4\">\n          Click \"Start Exercise\" to begin ear training.\n        </p>\n        <p className=\"text-sm\" style={{ color: 'var(--text-muted)' }}>\n          {mode === 'chord-basic' && 'Learn to distinguish between major and minor chords.'}\n          {mode === 'chord-seventh' && 'Identify different types of 7th chords.'}\n          {mode === 'scale-degree' && 'Train your ear to recognize scale degrees.'}\n        </p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Score Display */}\n      <div className=\"flex justify-between items-center\">\n        <div className=\"text-sm\" style={{ color: 'var(--text-secondary)' }}>\n          Question {questionNumber} of 10\n        </div>\n        <div className=\"text-sm font-medium\" style={{ color: 'var(--text-primary)' }}>\n          Score: {score.correct}/{score.total}\n          {score.total > 0 && (\n            <span style={{ color: 'var(--text-muted)' }} className=\"ml-2\">\n              ({scorePercentage}%)\n            </span>\n          )}\n        </div>\n      </div>\n\n      {/* Visual Indicator */}\n      <div \n        className=\"p-8 rounded-lg text-center\"\n        style={{ backgroundColor: 'var(--bg-tertiary)' }}\n      >\n        <div className=\"text-6xl mb-4\">ðŸŽ§</div>\n        <p className=\"text-lg font-medium\" style={{ color: 'var(--text-primary)' }}>\n          {getQuestionText()}\n        </p>\n        <button\n          onClick={handlePlayAgain}\n          className=\"btn-secondary mt-4 flex items-center gap-2 mx-auto\"\n          disabled={selectedAnswer !== null}\n        >\n          ðŸ”Š Play Again\n        </button>\n      </div>\n\n      {/* Answer Options */}\n      <div \n        className=\"grid grid-cols-2 gap-3 max-w-md mx-auto\"\n        role=\"group\"\n        aria-label={`Answer options. Press number keys 1 through ${options.length} to select an answer`}\n      >\n        {options.map((option, index) => {\n          let buttonStyle: React.CSSProperties = {\n            padding: '1rem',\n            borderRadius: '0.5rem',\n            fontWeight: 'bold',\n            transition: 'all 0.2s',\n            border: 'none',\n            cursor: selectedAnswer === null ? 'pointer' : 'default',\n          };\n          \n          if (selectedAnswer === null) {\n            buttonStyle.backgroundColor = 'var(--bg-tertiary)';\n            buttonStyle.color = 'var(--text-primary)';\n          } else if (option === correctAnswer) {\n            buttonStyle.backgroundColor = 'var(--success)';\n            buttonStyle.color = 'white';\n          } else if (option === selectedAnswer) {\n            buttonStyle.backgroundColor = 'var(--error)';\n            buttonStyle.color = 'white';\n          } else {\n            buttonStyle.backgroundColor = 'var(--bg-tertiary)';\n            buttonStyle.color = 'var(--text-muted)';\n            buttonStyle.opacity = 0.5;\n          }\n          \n          return (\n            <button\n              key={option}\n              onClick={() => handleAnswer(option)}\n              disabled={selectedAnswer !== null}\n              style={buttonStyle}\n              className=\"hover:opacity-90 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-blue-500\"\n              aria-label={`Option ${index + 1}: ${option}. Press ${index + 1} to select`}\n              aria-pressed={selectedAnswer === option}\n            >\n              <span className=\"sr-only\">{index + 1}: </span>\n              {option}\n            </button>\n          );\n        })}\n      </div>\n      {/* Keyboard hint */}\n      <p className=\"text-center text-xs\" style={{ color: 'var(--text-muted)' }}>\n        <span aria-hidden=\"true\">Tip: Press number keys to quickly select an answer</span>\n        <span className=\"sr-only\">Use number keys 1 through {options.length} to select answers</span>\n      </p>\n\n      {/* Feedback */}\n      {showFeedback && (\n        <div \n          className=\"text-center p-4 rounded-lg animate-fade-in\"\n          style={{ \n            backgroundColor: isCorrect ? 'rgba(16, 185, 129, 0.1)' : 'rgba(239, 68, 68, 0.1)',\n          }}\n          role=\"alert\"\n          aria-live=\"assertive\"\n        >\n          <p \n            className=\"font-medium text-lg\"\n            style={{ color: isCorrect ? 'var(--success)' : 'var(--error)' }}\n          >\n            <span aria-hidden=\"true\">{isCorrect ? 'âœ“' : 'âœ—'}</span>\n            {isCorrect ? ' Correct!' : ` Incorrect. The answer was ${correctAnswer}`}\n          </p>\n          {getHint() && (\n            <p className=\"text-sm mt-2\" style={{ color: 'var(--text-secondary)' }}>\n              Hint: {getHint()}\n            </p>\n          )}\n        </div>\n      )}\n\n      {/* Reference Guide */}\n      <div \n        className=\"p-4 rounded-lg\"\n        style={{ backgroundColor: 'var(--bg-tertiary)' }}\n      >\n        <h4 className=\"font-medium mb-2\" style={{ color: 'var(--text-primary)' }}>\n          Quick Reference\n        </h4>\n        <div className=\"text-sm space-y-1\" style={{ color: 'var(--text-secondary)' }}>\n          {mode === 'chord-basic' && (\n            <>\n              <p><strong>Major:</strong> Bright, happy, resolved</p>\n              <p><strong>Minor:</strong> Dark, sad, introspective</p>\n            </>\n          )}\n          {mode === 'chord-seventh' && (\n            <>\n              <p><strong>Major 7th:</strong> Dreamy, sophisticated</p>\n              <p><strong>Minor 7th:</strong> Mellow, smooth</p>\n              <p><strong>Dominant 7th:</strong> Tense, bluesy</p>\n            </>\n          )}\n          {mode === 'scale-degree' && (\n            <>\n              <p><strong>1 (Do):</strong> Home, stable</p>\n              <p><strong>5 (Sol):</strong> Strong, supportive</p>\n              <p><strong>7 (Ti):</strong> Leading tone, wants to resolve to 1</p>\n            </>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default EarTrainingExercise;\n"],"names":["KEYS","CHORD_QUALITIES","SCALE_DEGREES","EarTrainingExercise","exercise","score","questionNumber","isActive","recordAnswer","scorePercentage","useExercise","mode","setMode","useState","currentKey","setCurrentKey","correctAnswer","setCorrectAnswer","options","setOptions","selectedAnswer","setSelectedAnswer","isCorrect","setIsCorrect","showFeedback","setShowFeedback","currentChordNotes","setCurrentChordNotes","currentScaleNote","setCurrentScaleNote","useEffect","handleKeyDown","e","keyMap","index","handleAnswer","generateChordNotes","useCallback","rootNote","intervals","rootIndex","octave","interval","idx","noteIndex","noteOctave","generateQuestion","initAudio","key","qualities","quality","notes","q","playChord","tonicChord","degreeIndex","degree","noteInterval","note","playNote","handlePlayAgain","answer","correct","getQuestionText","getHint","jsxs","jsx","option","buttonStyle","Fragment"],"mappings":"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"}