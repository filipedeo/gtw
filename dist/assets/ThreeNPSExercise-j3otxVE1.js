import{u as G,c as H,d as z,r as h,n as C,s as k,j as e,F as O,g as I,i as A,f as U,p as Y}from"./index-CrYEXAxW.js";import{M as P,g as q}from"./theoryEngine-B3dQahfx.js";import{D as J}from"./DisplayModeToggle-DtggWZSM.js";import{P as L}from"./PracticeRating-PVheSIlz.js";import"./tone-BWNjRQgH.js";const Q=["C","Db","D","Eb","E","F","F#","G","Ab","A","Bb","B"];function M(d,m,p,N,y){const x=q(C(d),m);if(!x||x.length===0)return[];const S=x.map(n=>C(n)),v=[];let j=y;for(let n=0;n<N;n++){const l=[];for(let s=0;s<=22;s++){const f=I({string:n,fret:s},p),o=C(f.replace(/\d/,""));S.includes(o)&&l.push(s)}let g=[],r=1/0;for(let s=0;s<=l.length-3;s++){const a=[l[s],l[s+1],l[s+2]];if(a[2]-a[0]<=5){const f=(a[0]+a[2])/2,o=Math.abs(f-j-2);o<r&&(r=o,g=a)}}g.length===3&&(g.forEach(s=>v.push({string:n,fret:s})),j=Math.max(j,g[0]))}return v}const $=({exercise:d})=>{const{stringCount:m,tuning:p,setHighlightedPositions:N,setSecondaryHighlightedPositions:y,setRootNote:x,clearHighlights:S}=G(),{droneConfig:v,setDroneConfig:j,isDroneActive:n,setDroneActive:l}=H(),{isActive:g}=z(),[r,s]=h.useState("C"),[a,f]=h.useState(0),[o,T]=h.useState(0),[D,E]=h.useState(!1);h.useEffect(()=>{const i={"three-nps-1":0,"three-nps-2":1,"three-nps-phrygian":2,"three-nps-lydian":3,"three-nps-mixolydian":4,"three-nps-aeolian":5,"three-nps-locrian":6,"three-nps-harmonic-minor":7,"three-nps-melodic-minor":8}[d.id];i!==void 0&&f(i)},[d.id]);const b=P[a],F=h.useCallback(()=>{if(!g)return;const t=M(r,b.name,p,m,o);if(N(t),x(C(r)),d.id==="three-nps-3"){const i=(a+1)%P.length,w=P[i],c=o+2,u=M(r,w.name,p,m,c);y(u)}else y([])},[g,r,b,a,p,m,o,d.id,N,y,x]);h.useEffect(()=>{F()},[F]),h.useEffect(()=>()=>{S(),n&&(k(),l(!1))},[S,n,l]);const K=async()=>{await A(),n?(k(),l(!1)):(j({note:r,octave:2}),U({note:r,octave:2,volume:v.volume,waveform:v.waveform}),l(!0))},R=async()=>{if(D)return;await A(),E(!0);const i=[...M(r,b.name,p,m,o)].sort((c,u)=>c.string!==u.string?c.string-u.string:c.fret-u.fret),w=.2;for(let c=0;c<i.length;c++){const u=i[c],B=I(u,p);Y(B,{duration:.4,velocity:.7,delay:c*w})}setTimeout(()=>{E(!1)},i.length*w*1e3+500)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"var(--text-primary)"},children:"Mode / Pattern"}),e.jsx("select",{value:a,onChange:t=>f(parseInt(t.target.value)),className:"w-full px-3 py-2 rounded-lg",style:{backgroundColor:"var(--bg-primary)",color:"var(--text-primary)",border:"1px solid var(--border-color)"},children:P.map((t,i)=>e.jsxs("option",{value:i,children:["Pattern ",i+1," - ",t.displayName]},t.name))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"var(--text-primary)"},children:"Key"}),e.jsx("select",{value:r,onChange:t=>s(t.target.value),className:"w-full px-3 py-2 rounded-lg",style:{backgroundColor:"var(--bg-primary)",color:"var(--text-primary)",border:"1px solid var(--border-color)"},children:Q.map(t=>e.jsx("option",{value:t,children:t},t))})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",style:{color:"var(--text-primary)"},children:["Starting Fret Position: ",o]}),e.jsx("input",{type:"range",min:0,max:12,value:o,onChange:t=>T(parseInt(t.target.value)),className:"w-full"}),e.jsxs("div",{className:"flex justify-between text-xs",style:{color:"var(--text-muted)"},children:[e.jsx("span",{children:"Open"}),e.jsx("span",{children:"12th Fret"})]})]}),e.jsxs("div",{className:"p-4 rounded-lg",style:{backgroundColor:"rgba(59, 130, 246, 0.1)"},children:[e.jsxs("h4",{className:"font-medium mb-2",style:{color:"var(--accent-primary)"},children:["Pattern ",a+1," - ",b.displayName," (",r,")"]}),e.jsxs("p",{className:"text-sm",style:{color:"var(--text-secondary)"},children:["Characteristic note: ",e.jsx("strong",{children:b.characteristicNote})," ","—"," ","3 notes per string starting near fret ",o,".",m===7&&" Includes low B string for 7-string coverage."]})]}),e.jsx("div",{className:"flex items-center justify-between",children:e.jsx(J,{})}),e.jsx("div",{className:"card p-4",children:e.jsx(O,{interactive:!0})}),e.jsxs("div",{className:"flex gap-3 flex-wrap",children:[e.jsx("button",{onClick:K,className:n?"btn-danger":"btn-success",children:n?"Stop Drone":"Play Drone"}),e.jsx("button",{onClick:R,disabled:D,className:"btn-secondary disabled:opacity-50",children:D?"Playing...":"Play Scale"})]}),e.jsxs("div",{className:"p-4 rounded-lg",style:{backgroundColor:"var(--bg-tertiary)"},children:[e.jsx("h4",{className:"font-medium mb-2",style:{color:"var(--text-primary)"},children:"Practice Tips"}),e.jsxs("ul",{className:"text-sm space-y-1 list-disc list-inside",style:{color:"var(--text-secondary)"},children:[e.jsx("li",{children:"Every string gets exactly 3 notes — great for even alternate picking"}),e.jsx("li",{children:"All 7 patterns use just 3 finger shapes: whole-whole (1-3-5), whole-half (1-3-4), and half-whole (1-2-4)"}),e.jsx("li",{children:"Practice ascending and descending with strict alternate picking"}),e.jsx("li",{children:"Try legato (hammer-ons ascending, pull-offs descending) for smooth lines"}),e.jsx("li",{children:"Start slow with a metronome — increase speed only when clean"}),e.jsx("li",{children:"Use the drone to hear how each note relates to the tonal center"}),e.jsx("li",{children:"Connect adjacent patterns by sliding between them"}),e.jsx("li",{children:"Remove the highest and lowest note per string to reveal the pentatonic shape hiding inside each 3NPS pattern"})]})]}),e.jsx(L,{exerciseId:d.id,exerciseType:d.type})]})};export{$ as default,M as getThreeNPSPositions};
