import{r as o,i as F,l as x,p as L,j as e}from"./index-1OEwh6EN.js";import{u as U}from"./useExercise-CBo58W94.js";import"./tone-xN27a9Rt.js";const h=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],f={basic:[{name:"Major",intervals:[0,4,7],description:"Bright, happy"},{name:"Minor",intervals:[0,3,7],description:"Dark, sad"}],seventh:[{name:"Major 7th",intervals:[0,4,7,11],description:"Dreamy, jazzy"},{name:"Minor 7th",intervals:[0,3,7,10],description:"Mellow, smooth"},{name:"Dominant 7th",intervals:[0,4,7,10],description:"Tense, wants to resolve"}]},q=["1","2","3","4","5","6","7"],J=({exercise:u})=>{const{score:y,questionNumber:O,isActive:l,recordAnswer:P,scorePercentage:Q}=U({exerciseId:u.id,totalQuestions:10}),[n,j]=o.useState("chord-basic"),[R,H]=o.useState("C"),[m,b]=o.useState(""),[d,w]=o.useState([]),[c,S]=o.useState(null),[v,E]=o.useState(null),[K,A]=o.useState(!1),[I,N]=o.useState([]),[z,B]=o.useState("");o.useEffect(()=>{const t=r=>{if(!l||c!==null)return;const s={1:0,2:1,3:2,4:3,5:4,6:5,7:6};if(r.key in s){const a=s[r.key];a<d.length&&(r.preventDefault(),D(d[a]))}};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[l,c,d]),o.useEffect(()=>{u.id.includes("ear-1")?j("chord-basic"):u.id.includes("ear-2")?j("chord-seventh"):u.id.includes("ear-3")&&j("scale-degree")},[u.id]);const g=o.useCallback((t,r)=>{const s=h.indexOf(t.replace(/\d/,"")),a=3;return r.map((i,k)=>{const M=(s+i)%12,p=a+Math.floor((s+i)/12);return`${h[M]}${p+(k>2?1:0)}`})},[]),C=o.useCallback(async()=>{await F();const t=h[Math.floor(Math.random()*h.length)];if(H(t),n==="chord-basic"){const r=f.basic,s=r[Math.floor(Math.random()*r.length)],a=g(t,s.intervals);b(s.name),w(r.map(i=>i.name).sort(()=>Math.random()-.5)),N(a),setTimeout(()=>x(a,{duration:2,velocity:.6}),300)}else if(n==="chord-seventh"){const r=f.seventh,s=r[Math.floor(Math.random()*r.length)],a=g(t,s.intervals);b(s.name),w(r.map(i=>i.name).sort(()=>Math.random()-.5)),N(a),setTimeout(()=>x(a,{duration:2,velocity:.6}),300)}else if(n==="scale-degree"){const r=g(t,[0,4,7]),s=Math.floor(Math.random()*7),a=q[s],k=[0,2,4,5,7,9,11][s],M=(h.indexOf(t)+k)%12,p=`${h[M]}4`;b(a),w(q.sort(()=>Math.random()-.5)),N(r),B(p),setTimeout(()=>{x(r,{duration:1.5,velocity:.5}),setTimeout(()=>L(p,{duration:1.5,velocity:.7}),1800)},300)}S(null),E(null),A(!1)},[n,g]);o.useEffect(()=>{l&&C()},[l,C]);const T=async()=>{await F(),n==="scale-degree"?(x(I,{duration:1.5,velocity:.5}),setTimeout(()=>L(z,{duration:1.5,velocity:.7}),1800)):x(I,{duration:2,velocity:.6})},D=t=>{if(c!==null||!l)return;S(t);const r=t===m;E(r),A(!0),P(r),T(),setTimeout(()=>{y.total+1<10&&C()},2500)},G=()=>{switch(n){case"chord-basic":return"Is this chord Major or Minor?";case"chord-seventh":return"What type of 7th chord is this?";case"scale-degree":return`In the key of ${R}, what scale degree is this note?`;default:return"Listen and identify:"}},$=()=>n==="chord-basic"?f.basic.find(t=>t.name===m)?.description:n==="chord-seventh"?f.seventh.find(t=>t.name===m)?.description:null;return l?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm",style:{color:"var(--text-secondary)"},children:["Question ",O," of 10"]}),e.jsxs("div",{className:"text-sm font-medium",style:{color:"var(--text-primary)"},children:["Score: ",y.correct,"/",y.total,y.total>0&&e.jsxs("span",{style:{color:"var(--text-muted)"},className:"ml-2",children:["(",Q,"%)"]})]})]}),e.jsxs("div",{className:"p-8 rounded-lg text-center",style:{backgroundColor:"var(--bg-tertiary)"},children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸŽ§"}),e.jsx("p",{className:"text-lg font-medium",style:{color:"var(--text-primary)"},children:G()}),e.jsx("button",{onClick:T,className:"btn-secondary mt-4 flex items-center gap-2 mx-auto",disabled:c!==null,children:"ðŸ”Š Play Again"})]}),e.jsx("div",{className:"grid grid-cols-2 gap-3 max-w-md mx-auto",role:"group","aria-label":`Answer options. Press number keys 1 through ${d.length} to select an answer`,children:d.map((t,r)=>{let s={padding:"1rem",borderRadius:"0.5rem",fontWeight:"bold",transition:"all 0.2s",border:"none",cursor:c===null?"pointer":"default"};return c===null?(s.backgroundColor="var(--bg-tertiary)",s.color="var(--text-primary)"):t===m?(s.backgroundColor="var(--success)",s.color="white"):t===c?(s.backgroundColor="var(--error)",s.color="white"):(s.backgroundColor="var(--bg-tertiary)",s.color="var(--text-muted)",s.opacity=.5),e.jsxs("button",{onClick:()=>D(t),disabled:c!==null,style:s,className:"hover:opacity-90 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-blue-500","aria-label":`Option ${r+1}: ${t}. Press ${r+1} to select`,"aria-pressed":c===t,children:[e.jsxs("span",{className:"sr-only",children:[r+1,": "]}),t]},t)})}),e.jsxs("p",{className:"text-center text-xs",style:{color:"var(--text-muted)"},children:[e.jsx("span",{"aria-hidden":"true",children:"Tip: Press number keys to quickly select an answer"}),e.jsxs("span",{className:"sr-only",children:["Use number keys 1 through ",d.length," to select answers"]})]}),K&&e.jsxs("div",{className:"text-center p-4 rounded-lg animate-fade-in",style:{backgroundColor:v?"rgba(16, 185, 129, 0.1)":"rgba(239, 68, 68, 0.1)"},role:"alert","aria-live":"assertive",children:[e.jsxs("p",{className:"font-medium text-lg",style:{color:v?"var(--success)":"var(--error)"},children:[e.jsx("span",{"aria-hidden":"true",children:v?"âœ“":"âœ—"}),v?" Correct!":` Incorrect. The answer was ${m}`]}),$()&&e.jsxs("p",{className:"text-sm mt-2",style:{color:"var(--text-secondary)"},children:["Hint: ",$()]})]}),e.jsxs("div",{className:"p-4 rounded-lg",style:{backgroundColor:"var(--bg-tertiary)"},children:[e.jsx("h4",{className:"font-medium mb-2",style:{color:"var(--text-primary)"},children:"Quick Reference"}),e.jsxs("div",{className:"text-sm space-y-1",style:{color:"var(--text-secondary)"},children:[n==="chord-basic"&&e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Major:"})," Bright, happy, resolved"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Minor:"})," Dark, sad, introspective"]})]}),n==="chord-seventh"&&e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Major 7th:"})," Dreamy, sophisticated"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Minor 7th:"})," Mellow, smooth"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Dominant 7th:"})," Tense, bluesy"]})]}),n==="scale-degree"&&e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"1 (Do):"})," Home, stable"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"5 (Sol):"})," Strong, supportive"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"7 (Ti):"})," Leading tone, wants to resolve to 1"]})]})]})]})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{style:{color:"var(--text-secondary)"},className:"mb-4",children:'Click "Start Exercise" to begin ear training.'}),e.jsxs("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:[n==="chord-basic"&&"Learn to distinguish between major and minor chords.",n==="chord-seventh"&&"Identify different types of 7th chords.",n==="scale-degree"&&"Train your ear to recognize scale degrees."]})]})};export{J as default};
//# sourceMappingURL=EarTrainingExercise-XPgqIyrc.js.map
