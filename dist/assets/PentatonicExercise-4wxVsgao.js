import{u as U,c as Y,d as q,r as m,n as j,s as R,j as t,F as Q,g as w,i as O,f as V,p as W}from"./index-DZpW6sX_.js";import{a as C}from"./theoryEngine-CnTETf0l.js";import{D as X}from"./DisplayModeToggle-DvB9BASs.js";import"./tone-xN27a9Rt.js";const Z=["C","Db","D","Eb","E","F","F#","G","Ab","A","Bb","B"],ee=["Ionian (Major)","Dorian","Phrygian","Lydian","Mixolydian","Aeolian (Natural Minor)","Locrian"],te=[5,0,1,2,4],se=[0,1,2,4,5],oe=["Root","b3","4","5","b7"],ne=["Root","2","3","5","6"];function B(f,N,u,E,M){const b=C(f,N==="minor"?"minor pentatonic":"major pentatonic");if(!b||b.length===0)return[];const v=b.map(e=>j(e)),P=[];for(let e=0;e<=17;e++){const a=w({string:0,fret:e},E),n=j(a.replace(/\d+$/,""));v.includes(n)&&P.push({fret:e,note:n})}const h=v[0],p=P.findIndex(e=>e.note===h);if(p===-1)return[];const S=p+u;if(S>=P.length)return[];let o=P[S].fret;o>12&&(o-=12);const c=[];for(let e=0;e<M;e++){const a=[];for(let r=0;r<=22;r++){const i=w({string:e,fret:r},E),x=j(i.replace(/\d+$/,""));v.includes(x)&&a.push(r)}let n=[],l=1/0;for(let r=0;r<a.length-1;r++){const i=[a[r],a[r+1]];if(i[0]>=o-1&&i[1]<=o+4){const x=Math.abs(i[0]-o);x<l&&(l=x,n=i)}}if(n.length===0)for(let r=0;r<a.length-1;r++){const i=[a[r],a[r+1]];if(i[1]-i[0]<=5){const x=(i[0]+i[1])/2,k=Math.abs(x-(o+1.5));k<l&&(l=k,n=i)}}n.forEach(r=>c.push({string:e,fret:r}))}return c}function re(f,N,u,E,M){if(f.length===0)return[];const D=u==="minor"?"minor pentatonic":"major pentatonic",b=u==="minor"?"aeolian":"major",v=C(N,D).map(e=>j(e)),h=C(N,b).map(e=>j(e)).filter(e=>!v.includes(e));if(h.length===0)return[];const p=f.map(e=>e.fret),S=Math.min(...p),o=Math.max(...p),c=[];for(let e=0;e<M;e++)for(let a=Math.max(0,S-1);a<=o+1;a++){const n=w({string:e,fret:a},E),l=j(n.replace(/\d+$/,""));h.includes(l)&&c.push({string:e,fret:a})}return c}const de=({exercise:f})=>{const{stringCount:N,tuning:u,setHighlightedPositions:E,setSecondaryHighlightedPositions:M,setRootNote:D,clearHighlights:b}=U(),{droneConfig:v,setDroneConfig:P,isDroneActive:h,setDroneActive:p}=Y(),{isActive:S}=q(),[o,c]=m.useState("A"),[e,a]=m.useState("minor"),[n,l]=m.useState(0),[r,i]=m.useState(!1),[x,k]=m.useState(!1);m.useEffect(()=>{f.id==="pentatonic-1"||f.id==="pentatonic-2"?(a("minor"),l(0),i(!1),c("A")):f.id==="pentatonic-3"?(a("major"),l(0),i(!1),c("C")):f.id==="pentatonic-4"&&(a("minor"),l(0),i(!0),c("A"))},[f.id]);const $=e==="minor"?te:se,G=e==="minor"?oe:ne,T=ee[$[n]],K=G[n],L=m.useCallback(()=>{const s=e==="minor"?"minor pentatonic":"major pentatonic",g=e==="minor"?"aeolian":"major",A=C(o,s).map(d=>j(d));return C(o,g).map(d=>j(d)).filter(d=>!A.includes(d))},[o,e]),H=m.useCallback(()=>{const g=C(o,e==="minor"?"minor pentatonic":"major pentatonic");return n<g.length?g[n]:o},[o,e,n]),_=m.useCallback(()=>{if(!S)return;const s=B(o,e,n,u,N);if(E(s),D(j(o)),r){const g=re(s,o,e,u,N);M(g)}else M([])},[S,o,e,n,r,u,N,E,M,D]);m.useEffect(()=>{_()},[_]),m.useEffect(()=>()=>{b(),h&&(R(),p(!1))},[b,h,p]);const z=async()=>{await O(),h?(R(),p(!1)):(P({note:o,octave:2}),V({note:o,octave:2,volume:v.volume,waveform:v.waveform}),p(!0))},J=async()=>{if(x)return;await O(),k(!0);const g=[...B(o,e,n,u,N)].sort((y,d)=>y.string!==d.string?y.string-d.string:y.fret-d.fret),A=.25;for(let y=0;y<g.length;y++){const d=w(g[y],u);W(d,{duration:.4,velocity:.7,delay:y*A})}setTimeout(()=>k(!1),g.length*A*1e3+500)};if(!S)return t.jsxs("div",{className:"text-center py-8",children:[t.jsx("p",{style:{color:"var(--text-secondary)"},className:"mb-4",children:'Click "Start Exercise" to explore pentatonic shapes.'}),t.jsxs("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:[e==="minor"?"Minor":"Major"," pentatonic — the foundation of guitar soloing."]})]});const F=L(),I=H();return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"var(--text-primary)"},children:"Scale Type"}),t.jsx("div",{className:"flex gap-2",children:["minor","major"].map(s=>t.jsxs("button",{onClick:()=>a(s),className:`flex-1 py-2 rounded-lg font-medium transition-all ${e===s?"btn-primary":""}`,style:e!==s?{backgroundColor:"var(--bg-tertiary)",color:"var(--text-secondary)"}:{},children:[s==="minor"?"Minor":"Major"," Pent."]},s))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"var(--text-primary)"},children:"Key"}),t.jsx("select",{value:o,onChange:s=>c(s.target.value),className:"w-full px-3 py-2 rounded-lg",style:{backgroundColor:"var(--bg-primary)",color:"var(--text-primary)",border:"1px solid var(--border-color)"},children:Z.map(s=>t.jsxs("option",{value:s,children:[s," ",e==="minor"?"Minor":"Major"," Pentatonic"]},s))})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"var(--text-primary)"},children:"Shape / Box"}),t.jsx("div",{className:"flex gap-2",children:[0,1,2,3,4].map(s=>t.jsx("button",{onClick:()=>l(s),className:`flex-1 py-2 rounded-lg font-bold transition-all ${n===s?"btn-primary":""}`,style:n!==s?{backgroundColor:"var(--bg-tertiary)",color:"var(--text-secondary)"}:{},children:s+1},s))})]}),t.jsxs("div",{className:"p-4 rounded-lg",style:{backgroundColor:"rgba(59, 130, 246, 0.1)"},children:[t.jsxs("h4",{className:"font-medium mb-2",style:{color:"var(--accent-primary)"},children:["Shape ",n+1," — ",o," ",e==="minor"?"Minor":"Major"," Pentatonic"]}),t.jsxs("div",{className:"text-sm space-y-1",style:{color:"var(--text-secondary)"},children:[t.jsxs("p",{children:["Starts from the ",t.jsx("strong",{children:K})," (",I,") on the lowest string"]}),t.jsxs("p",{children:["Extends to: ",t.jsxs("strong",{children:[I," ",T]})," by adding ",F.join(" and ")]})]})]}),t.jsxs("div",{className:"flex flex-wrap gap-4 items-center",children:[t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:r,onChange:s=>i(s.target.checked),className:"rounded"}),t.jsxs("span",{className:"text-sm",style:{color:"var(--text-primary)"},children:["Show Full Scale (+",F.join(", "),")"]})]}),t.jsx(X,{})]}),t.jsx("div",{className:"card p-4",children:t.jsx(Q,{interactive:!0})}),t.jsxs("div",{className:"flex gap-3 flex-wrap",children:[t.jsx("button",{onClick:z,className:h?"btn-danger":"btn-success",children:h?"Stop Drone":"Play Drone"}),t.jsx("button",{onClick:J,disabled:x,className:"btn-secondary disabled:opacity-50",children:x?"Playing...":"Play Scale"})]}),t.jsxs("div",{className:"p-4 rounded-lg",style:{backgroundColor:"var(--bg-tertiary)"},children:[t.jsx("h4",{className:"font-medium mb-2",style:{color:"var(--text-primary)"},children:"Practice Tips"}),t.jsxs("ul",{className:"text-sm space-y-1 list-disc list-inside",style:{color:"var(--text-secondary)"},children:[t.jsx("li",{children:"Master each shape individually before connecting them"}),t.jsx("li",{children:"Practice ascending and descending through the box"}),t.jsx("li",{children:'Toggle "Show Full Scale" to see the 2 notes that complete the mode'}),t.jsx("li",{children:"Try the same lick in all 5 shapes to build fretboard freedom"}),t.jsx("li",{children:"Use the drone to hear how pentatonic notes relate to the root"}),r&&t.jsxs("li",{children:["The faded notes (",F.join(" and "),") turn this into ",I," ",T]})]})]})]})};export{de as default};
