import{d as h,o as k,r as e}from"./index-Cay9Vtxh.js";const y=10;function M(w){const{exerciseId:n,exerciseType:p,totalQuestions:a=y,onComplete:l}=w,{isActive:o,recordAttempt:d,endExercise:E,startTime:u}=h(),{recordExerciseCompletion:x,updateReviewItem:S}=k(),[t,i]=e.useState({correct:0,total:0}),[f,m]=e.useState(!1),s=e.useRef(!1);e.useEffect(()=>{o&&(i({correct:0,total:0}),m(!1),s.current=!1)},[o]),e.useEffect(()=>()=>{s.current=!1},[]);const I=e.useCallback(C=>{!o||f||(i(A=>{const r={correct:A.correct+(C?1:0),total:A.total+1};if(r.total>=a){if(s.current)return r;s.current=!0,m(!0);const c=r.correct/r.total,T=u?(Date.now()-u)/1e3:0;x(n,c,T,p);const D=c>=.8?5:c>=.6?3:1;S(n,D),E({exerciseId:n,score:c,timeSpent:T,attempts:r.total,completedAt:new Date}),l&&l(c)}return r}),d(C))},[o,f,a,u,n,p,d,x,S,E,l]),R=e.useCallback(()=>{i({correct:0,total:0}),m(!1),s.current=!1},[]),b=t.total>0?Math.round(t.correct/t.total*100):0,g=a-t.total,q=Math.min(t.total+1,a);return{score:t,questionNumber:q,isComplete:f,isActive:o,recordAnswer:I,resetExercise:R,scorePercentage:b,questionsRemaining:g}}export{M as u};
