import{d as D,m as h,r as e}from"./index-CgE2jpUT.js";const k=10;function M(w){const{exerciseId:n,totalQuestions:a=k,onComplete:l}=w,{isActive:o,recordAttempt:p,endExercise:d,startTime:u}=D(),{recordExerciseCompletion:E,updateReviewItem:S}=h(),[t,i]=e.useState({correct:0,total:0}),[f,m]=e.useState(!1),s=e.useRef(!1);e.useEffect(()=>{o&&(i({correct:0,total:0}),m(!1),s.current=!1)},[o]),e.useEffect(()=>()=>{s.current=!1},[]);const T=e.useCallback(x=>{!o||f||(i(C=>{const r={correct:C.correct+(x?1:0),total:C.total+1};if(r.total>=a){if(s.current)return r;s.current=!0,m(!0);const c=r.correct/r.total,A=u?(Date.now()-u)/1e3:0;E(n,c,A);const q=c>=.8?5:c>=.6?3:1;S(n,q),d({exerciseId:n,score:c,timeSpent:A,attempts:r.total,completedAt:new Date}),l&&l(c)}return r}),p(x))},[o,f,a,u,n,p,E,S,d,l]),I=e.useCallback(()=>{i({correct:0,total:0}),m(!1),s.current=!1},[]),R=t.total>0?Math.round(t.correct/t.total*100):0,b=a-t.total,g=Math.min(t.total+1,a);return{score:t,questionNumber:g,isComplete:f,isActive:o,recordAnswer:T,resetExercise:I,scorePercentage:R,questionsRemaining:b}}export{M as u};
