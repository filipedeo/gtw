import{u as he,c as pe,d as ge,r as n,n as q,e as ee,s as te,j as e,F as fe,q as xe,i as se,f as be,p as ye}from"./index-CwJpEdkT.js";import{c as K}from"./theoryEngine-Kyf7K1I3.js";import{D as ve}from"./DisplayModeToggle-BpGImax5.js";import{P as je}from"./PracticeRating-BzD00yR0.js";import"./tone-BWNjRQgH.js";const Ne=["C","Db","D","Eb","E","F","F#","G","Ab","A","Bb","B"],Se=[{label:"Open/1st",minFret:0,maxFret:4},{label:"5th Position",minFret:5,maxFret:8},{label:"9th Position",minFret:9,maxFret:12},{label:"12th Position",minFret:12,maxFret:16},{label:"Upper Frets",minFret:17,maxFret:24}],Pe=[{value:"major",label:"Major",shortLabel:"Maj"},{value:"minor",label:"Minor",shortLabel:"Min"},{value:"dominant",label:"Dominant",shortLabel:"Dom"},{value:"diminished",label:"Diminished",shortLabel:"Dim"},{value:"half-diminished",label:"Half-Diminished",shortLabel:"m7b5"},{value:"augmented",label:"Augmented",shortLabel:"Aug"},{value:"sus2",label:"Suspended 2",shortLabel:"Sus2"},{value:"sus4",label:"Suspended 4",shortLabel:"Sus4"}],ke=[{value:"triad",label:"Triad"},{value:"6",label:"6th"},{value:"7",label:"7th"},{value:"add9",label:"add9"},{value:"9",label:"9th"},{value:"11",label:"11th"},{value:"13",label:"13th"}],Ce={"bass-arp-1":{type:"major",extension:"7"},"bass-arp-2":{type:"minor",extension:"7"},"bass-arp-3":{type:"dominant",extension:"7"},"bass-arp-4":{type:"minor",extension:"7"},"guitar-arp-1":{type:"major",extension:"7"},"guitar-arp-2":{type:"minor",extension:"7"},"guitar-arp-3":{type:"dominant",extension:"7"},"guitar-arp-4":{type:"diminished",extension:"7"},"guitar-arp-5":{type:"augmented",extension:"triad"},"guitar-arp-6":{type:"half-diminished",extension:"7"}};function Fe(r){switch(r){case"major":return["triad","6","7","add9","9","11","13"];case"minor":return["triad","6","7","add9","9","11","13"];case"dominant":return["7","9","11","13"];case"diminished":return["triad","7"];case"half-diminished":return["7"];case"augmented":return["triad","7"];case"sus2":return["triad","7","add9"];case"sus4":return["triad","7"];default:return["triad","7"]}}function we(r,a){switch(r){case"major":switch(a){case"triad":return"";case"6":return"6";case"7":return"maj7";case"add9":return"add9";case"9":return"maj9";case"11":return"maj11";case"13":return"maj13";default:return"maj7"}case"minor":switch(a){case"triad":return"m";case"6":return"m6";case"7":return"m7";case"add9":return"madd9";case"9":return"m9";case"11":return"m11";case"13":return"m13";default:return"m7"}case"dominant":switch(a){case"7":return"7";case"9":return"9";case"11":return"11";case"13":return"13";default:return"7"}case"diminished":switch(a){case"triad":return"dim";case"7":return"dim7";default:return"dim7"}case"half-diminished":return"m7b5";case"augmented":switch(a){case"triad":return"aug";case"7":return"aug7";default:return"aug"}case"sus2":switch(a){case"triad":return"sus2";case"7":return"7sus2";case"add9":return"sus2";default:return"sus2"}case"sus4":switch(a){case"triad":return"sus4";case"7":return"7sus4";default:return"sus4"}default:return""}}function Me(r,a){const s=["Root"];return r==="sus2"?s.push("Major 2nd"):r==="sus4"?s.push("Perfect 4th"):r==="minor"||r==="diminished"||r==="half-diminished"?s.push("Minor 3rd"):s.push("Major 3rd"),r==="diminished"||r==="half-diminished"?s.push("Diminished 5th"):r==="augmented"?s.push("Augmented 5th"):s.push("Perfect 5th"),a==="6"?s.push("Major 6th"):a==="add9"?s.push("Major 9th"):(a==="7"||a==="9"||a==="11"||a==="13")&&(r==="major"?s.push("Major 7th"):r==="diminished"?s.push("Diminished 7th"):s.push("Minor 7th"),(a==="9"||a==="11"||a==="13")&&s.push("Major 9th"),(a==="11"||a==="13")&&s.push("Perfect 11th"),a==="13"&&s.push("Major 13th")),s}function Ee(r,a,s,N){const C=r.map(d=>xe(d,a,s,N)),S=[],F=new Set;for(let d=0;d<=s-r.length;d++){let g=function(f,l){if(f===L.length){const c=l.map(A=>A.fret),x=Math.min(...c),I=Math.max(...c),i=I-x;if(i<=5){const A=l.map(u=>`${u.string}-${u.fret}`).join("|");F.has(A)||(F.add(A),S.push({positions:[...l],startingString:d,minFret:x,maxFret:I,fretSpan:i}))}return}for(const c of L[f]){if(l.length>0){const x=l[0].fret;if(Math.abs(c.fret-x)>5)continue}l.push(c),g(f+1,l),l.pop()}};const L=r.map((f,l)=>C[l].filter(c=>c.string===d+l));L.some(f=>f.length===0)||g(0,[])}return S.sort((d,g)=>d.minFret!==g.minFret?d.minFret-g.minFret:d.startingString-g.startingString),S}function Ae(r){return Se.find(s=>r>=s.minFret&&r<=s.maxFret)?.label||`Fret ${r}`}function De(r){const a=new Map;for(const s of r){const C=`${Ae(s.minFret)}`;a.has(C)||a.set(C,[]),a.get(C).push(s)}return a}const Te=({exercise:r})=>{const{instrument:a,stringCount:s,tuning:N,fretCount:C,setHighlightedPositions:S,setSecondaryHighlightedPositions:F,setRootNote:d,clearHighlights:g}=he(),L=a==="guitar",{droneConfig:f,setDroneConfig:l,isDroneActive:c,setDroneActive:x}=pe(),{isActive:I}=ge(),[i,A]=n.useState("C"),[u,J]=n.useState("major"),[w,z]=n.useState("7"),[B,re]=n.useState(!0),[U,V]=n.useState(!1),[D,Q]=n.useState(-1),[ae,X]=n.useState(0),[m,W]=n.useState(""),M=n.useRef([]),H=n.useMemo(()=>Fe(u),[u]);n.useEffect(()=>{H.includes(w)||z(H[0])},[u,H,w]),n.useEffect(()=>{const t=Ce[r.id];t&&(J(t.type),z(t.extension))},[r.id]);const P=n.useMemo(()=>we(u,w),[u,w]),R=B?C:12,O=n.useMemo(()=>{const t=`${i}${P}`,o=K(t);if(!o||o.length===0)return[];const p=o.map(k=>q(k));return Ee(p,N,s,R)},[i,P,N,s,R]),T=n.useMemo(()=>De(O),[O]),ne=n.useMemo(()=>Array.from(T.keys()),[T]),_=n.useMemo(()=>!m||m==="all"?O:T.get(m)||[],[O,T,m]),$=Math.min(ae,Math.max(0,_.length-1)),h=_[$],G=h?.positions||[];n.useEffect(()=>{X(0)},[i,P,m]);const Z=n.useCallback(()=>{if(I)try{const t=`${i}${P}`,o=K(t);if(o&&o.length>0){const p=o.map(b=>q(b)),k=q(i);if(d(k),D>=0&&D<G.length){const b=G[D],y=G.filter((E,v)=>v!==D);S([b]),F(y)}else if(h){const b=h.positions.filter((E,v)=>v===0),y=h.positions.filter((E,v)=>v!==0);S(y),F(b)}else{const b=ee([k],N,s,R),y=p.filter(v=>v!==k),E=ee(y,N,s,R);S(E),F(b)}}}catch(t){console.error("Error computing arpeggio positions:",t)}},[i,P,B,I,D,s,N,R,G,h,S,F,d]);n.useEffect(()=>{Z()},[Z]),n.useEffect(()=>{c&&l({note:i,octave:2})},[i,c,l]),n.useEffect(()=>()=>{M.current.forEach(t=>clearTimeout(t)),M.current=[],g(),c&&(te(),x(!1))},[g,c,x]);const ie=async()=>{await se(),c?(te(),x(!1)):(l({note:i,octave:2}),be({note:i,octave:2,volume:f.volume,waveform:f.waveform}),x(!0))},oe=async()=>{if(U)return;await se(),V(!0),M.current.forEach(p=>clearTimeout(p)),M.current=[];const t=`${i}${P}`,o=K(t);if(o&&o.length>0){const k=o.map(j=>`${j}2`),b=[...k].reverse().slice(1),y=[...k,...b],E=o.map((j,Y)=>Y),v=[...E].reverse().slice(1),ue=[...E,...v];for(let j=0;j<y.length;j++){ye(y[j],{duration:.5,velocity:.7,delay:j*.35});const Y=setTimeout(()=>{Q(ue[j])},j*.35*1e3);M.current.push(Y)}const me=setTimeout(()=>{Q(-1),V(!1),M.current=[]},y.length*.35*1e3+500);M.current.push(me)}else V(!1)},le=`${i}${P}`,ce=K(le),de=Me(u,w);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"var(--text-primary)"},children:"Chord Type"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Pe.map(t=>e.jsx("button",{onClick:()=>J(t.value),className:`px-3 py-2 rounded-lg font-medium transition-all ${u===t.value?"btn-primary":""}`,style:u!==t.value?{backgroundColor:"var(--bg-tertiary)",color:"var(--text-secondary)"}:{},children:t.shortLabel},t.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"var(--text-primary)"},children:"Extension"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:ke.filter(t=>H.includes(t.value)).map(t=>e.jsx("button",{onClick:()=>z(t.value),className:`px-3 py-2 rounded-lg font-medium transition-all ${w===t.value?"btn-primary":""}`,style:w!==t.value?{backgroundColor:"var(--bg-tertiary)",color:"var(--text-secondary)"}:{},children:t.label},t.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"var(--text-primary)"},children:"Key"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:Ne.map(t=>e.jsx("button",{onClick:()=>A(t),className:`px-3 py-2 rounded-lg font-medium transition-all min-w-[44px] ${i===t?"btn-primary":""}`,style:i!==t?{backgroundColor:"var(--bg-tertiary)",color:"var(--text-secondary)"}:{},children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"var(--text-primary)"},children:"Position"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:()=>W("all"),className:`px-3 py-2 rounded-lg font-medium transition-all text-sm ${m==="all"||m===""?"btn-primary":""}`,style:m!=="all"&&m!==""?{backgroundColor:"var(--bg-tertiary)",color:"var(--text-secondary)"}:{},children:["All (",O.length,")"]}),ne.map(t=>e.jsxs("button",{onClick:()=>W(t),className:`px-3 py-2 rounded-lg font-medium transition-all text-sm ${m===t?"btn-primary":""}`,style:m!==t?{backgroundColor:"var(--bg-tertiary)",color:"var(--text-secondary)"}:{},children:[t," (",T.get(t)?.length||0,")"]},t))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",style:{color:"var(--text-primary)"},children:["Shape Variation (",$+1," of ",_.length,")"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>X(Math.max(0,$-1)),disabled:$===0,className:"px-3 py-2 rounded-lg disabled:opacity-50",style:{backgroundColor:"var(--bg-primary)",color:"var(--text-primary)",border:"1px solid var(--border-color)"},children:"Prev"}),e.jsx("div",{className:"flex-1 px-3 py-2 rounded-lg text-center text-sm",style:{backgroundColor:"var(--bg-secondary)",color:"var(--text-secondary)"},children:h?e.jsxs(e.Fragment,{children:["Strings ",h.startingString+1,"-",h.startingString+h.positions.length,", Frets ",h.minFret,"-",h.maxFret]}):"No shapes available"}),e.jsx("button",{onClick:()=>X(Math.min(_.length-1,$+1)),disabled:$>=_.length-1,className:"px-3 py-2 rounded-lg disabled:opacity-50",style:{backgroundColor:"var(--bg-primary)",color:"var(--text-primary)",border:"1px solid var(--border-color)"},children:"Next"})]})]}),e.jsxs("div",{className:"p-4 rounded-lg",style:{backgroundColor:"rgba(59, 130, 246, 0.1)"},children:[e.jsxs("h4",{className:"font-medium mb-2",style:{color:"var(--accent-primary)"},children:[i,P," Arpeggio"]}),e.jsx("div",{className:"flex flex-wrap gap-3",children:ce.map((t,o)=>{const p=D===o;return e.jsxs("div",{className:"flex flex-col items-center px-3 py-2 rounded-lg transition-all",style:{backgroundColor:p?"var(--accent-primary)":"var(--bg-primary)",border:`1px solid ${p?"var(--accent-primary)":"var(--border-color)"}`,color:p?"white":"var(--text-primary)",transform:p?"scale(1.1)":"scale(1)"},children:[e.jsx("span",{className:"text-sm font-bold",children:t}),e.jsx("span",{className:"text-xs",style:{opacity:.7},children:de[o]||""})]},o)})})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm",style:{color:"var(--text-primary)"},children:[e.jsx("input",{type:"checkbox",checked:B,onChange:t=>re(t.target.checked),className:"rounded"}),"Full fretboard"]}),e.jsx(ve,{})]}),e.jsx("div",{className:"card p-4",children:e.jsx(fe,{interactive:!0})}),e.jsxs("div",{className:"flex gap-3 flex-wrap",children:[e.jsx("button",{onClick:ie,className:c?"btn-danger":"btn-success",children:c?"Stop Drone":"Play Drone"}),e.jsx("button",{onClick:oe,disabled:U,className:"btn-secondary disabled:opacity-50",children:U?"Playing...":"Play Arpeggio"})]}),e.jsxs("div",{className:"p-4 rounded-lg",style:{backgroundColor:"var(--bg-tertiary)"},children:[e.jsx("h4",{className:"font-medium mb-2",style:{color:"var(--text-primary)"},children:"Practice Tips"}),e.jsxs("ul",{className:"text-sm space-y-1 list-disc list-inside",style:{color:"var(--text-secondary)"},children:[L?e.jsxs(e.Fragment,{children:[e.jsx("li",{children:"Practice sweep picking â€” use a continuous downstroke across strings ascending, upstroke descending"}),e.jsx("li",{children:"Start slowly with a metronome"}),e.jsx("li",{children:"Mute strings after playing to keep the arpeggio clean"}),e.jsx("li",{children:"Economy of motion: keep your pick close to the strings"}),e.jsx("li",{children:"Learn each inversion: start on the root, 3rd, 5th, and 7th"}),e.jsx("li",{children:"Practice connecting arpeggio shapes across positions on the neck"}),e.jsx("li",{children:"Over a chord progression, switch arpeggios to outline the harmony"})]}):e.jsxs(e.Fragment,{children:[e.jsx("li",{children:"Play the arpeggio ascending and descending with even tone"}),e.jsx("li",{children:"Use alternating fingers (index-middle) for consistent attack"}),e.jsx("li",{children:"Learn each inversion: start on the root, 3rd, 5th, and 7th"}),e.jsx("li",{children:"Practice connecting arpeggio shapes across positions on the neck"}),e.jsx("li",{children:"Over a chord progression, switch arpeggios to outline the harmony"}),r.id==="bass-arp-4"&&e.jsx("li",{children:"For inversions, start on each chord tone in turn: root position, 1st, 2nd, 3rd inversion"})]}),e.jsx("li",{children:"Use the drone to hear how each arpeggio tone relates to the root"})]})]}),e.jsx(je,{exerciseId:r.id,exerciseType:r.type})]})};export{Te as default};
